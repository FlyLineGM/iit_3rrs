(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    269704,       7087]
NotebookOptionsPosition[    262564,       6868]
NotebookOutlinePosition[    262905,       6883]
CellTagsIndexPosition[    262862,       6880]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"\"\<rotationUtilsRobotics.m\>\"", ",", 
   RowBox[{"Path", "\[Rule]", " ", 
    RowBox[{"NotebookDirectory", "[", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{3.675695386529961*^9, 3.689474267282737*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"size", "[", "x_", "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Size of the expression is:\>\"", ",", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"ByteCount", "[", "x", "]"}], "/", "1000"}], "]"}], ",", 
     "\"\< KB.\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"val2rule", "[", 
    RowBox[{"var_", ",", "data_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"len", ",", "rule", ",", "ii"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{"Length", "[", "var", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rule", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "len"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "\[LessEqual]", " ", "len"}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"rule", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", " ", 
           RowBox[{"data", "[", 
            RowBox[{"[", "ii", "]"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "rule", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.689474293635285*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"configuration", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Theta]1", ",", "\[Theta]2", ",", "\[Theta]3", ",", "\[Phi]1", ",", 
       "\[Phi]2", ",", "\[Phi]3", ",", "c1", ",", "c2", ",", "z"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Active", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"\[Theta]", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", "\[Theta]3"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Passive", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Phi]", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\[Phi]1", ",", "\[Phi]2", ",", "\[Phi]3", ",", "c1", ",", "c2", ",", 
       "z"}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.62349205600453*^9, 3.623492078795195*^9}, {
  3.623989778779044*^9, 3.623989803512684*^9}, {3.675531558252204*^9, 
  3.6755315730518847`*^9}, {3.675695486696787*^9, 3.675695499408709*^9}, {
  3.679011490542527*^9, 3.679011506031837*^9}}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Psi]", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\[Psi]1", ",", "\[Psi]2", ",", "\[Psi]3"}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Gamma]", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\[Gamma]1", ",", "\[Gamma]2", ",", "\[Gamma]3"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.613813234856614*^9, 3.613813251136339*^9}, {
   3.613813331068469*^9, 3.613813465924182*^9}, {3.613815436147964*^9, 
   3.613815475533395*^9}, {3.624070250768293*^9, 3.624070332555275*^9}, 
   3.675695638634693*^9, {3.675729933535481*^9, 3.675729939022874*^9}, 
   3.679011501269926*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "substitute", " ", "variables", " ", "as", " ", "functions", " ", "of", 
    " ", "time"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"subsqt", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]1", "\[Rule]", " ", 
        RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
       RowBox[{"\[Theta]2", "\[Rule]", " ", 
        RowBox[{"\[Theta]2", "[", "t", "]"}]}], ",", 
       RowBox[{"\[Theta]3", "\[Rule]", " ", 
        RowBox[{"\[Theta]3", "[", "t", "]"}]}], ",", 
       RowBox[{"\[Phi]1", "\[Rule]", " ", 
        RowBox[{"\[Phi]1", "[", "t", "]"}]}], ",", 
       RowBox[{"\[Phi]2", "\[Rule]", " ", 
        RowBox[{"\[Phi]2", "[", "t", "]"}]}], ",", 
       RowBox[{"\[Phi]3", "\[Rule]", " ", 
        RowBox[{"\[Phi]3", "[", "t", "]"}]}], ",", 
       RowBox[{"c1", "\[Rule]", " ", 
        RowBox[{"c1", "[", "t", "]"}]}], ",", 
       RowBox[{"c2", "\[Rule]", " ", 
        RowBox[{"c2", "[", "t", "]"}]}], ",", 
       RowBox[{"z", "\[Rule]", " ", 
        RowBox[{"z", "[", "t", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qt", "=", 
     RowBox[{"q", "/.", "subsqt"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675696684577238*^9, 3.675696728420106*^9}, {
  3.6757300849214163`*^9, 3.675730119433938*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cayley2r", "[", 
     RowBox[{"{", 
      RowBox[{"c1_", ",", "c2_", ",", "c3_"}], "}"}], "]"}], ":=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", 
        RowBox[{"axis2skew", "[", 
         RowBox[{"{", 
          RowBox[{"c1", ",", "c2", ",", "c3"}], "}"}], "]"}]}], ")"}], ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "3", "]"}], "-", 
        RowBox[{"axis2skew", "[", 
         RowBox[{"{", 
          RowBox[{"c1", ",", "c2", ",", "c3"}], "}"}], "]"}]}], "]"}]}], 
     "]"}]}], ";"}], "  "}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RTp", "=", 
  RowBox[{"cayley2r", "[", 
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "0"}], "}"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "-", 
       SuperscriptBox["c2", "2"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "+", 
       SuperscriptBox["c2", "2"]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", "c1", " ", "c2"}], 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "+", 
       SuperscriptBox["c2", "2"]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", "c2"}], 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "+", 
       SuperscriptBox["c2", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "c1", " ", "c2"}], 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "+", 
       SuperscriptBox["c2", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "-", 
       SuperscriptBox["c1", "2"], "+", 
       SuperscriptBox["c2", "2"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "+", 
       SuperscriptBox["c2", "2"]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "c1"}], 
       RowBox[{"1", "+", 
        SuperscriptBox["c1", "2"], "+", 
        SuperscriptBox["c2", "2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "c2"}], 
       RowBox[{"1", "+", 
        SuperscriptBox["c1", "2"], "+", 
        SuperscriptBox["c2", "2"]}]]}], ",", 
     FractionBox[
      RowBox[{"2", " ", "c1"}], 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "+", 
       SuperscriptBox["c2", "2"]}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["c1", "2"], "+", 
        SuperscriptBox["c2", "2"]}], 
       RowBox[{"1", "+", 
        SuperscriptBox["c1", "2"], "+", 
        SuperscriptBox["c2", "2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.67572981753482*^9, 3.675729885118148*^9}, 
   3.675748311289536*^9, 3.675759358035328*^9, 3.675761794079671*^9, 
   3.675773416899637*^9, 3.675789012098475*^9, 3.675941987260749*^9, 
   3.676034827255199*^9, 3.676058118501115*^9, 3.676058430216942*^9, 
   3.6760852563179903`*^9, 3.676095611014161*^9, 3.676096560300539*^9, 
   3.679011530655159*^9, 3.679099468930399*^9, 3.679195497334182*^9, 
   3.679462307552578*^9, 3.689474330153349*^9, 3.68949570809723*^9, 
   3.689556880199204*^9, 3.689582339623849*^9, 3.68964122380914*^9, 
   3.69666709191929*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]sol", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"skew2axis", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"cayley2r", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c1", "[", "t", "]"}], ",", 
              RowBox[{"c2", "[", "t", "]"}], ",", "0"}], "}"}], "]"}], ",", 
           "t"}], "]"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"Transpose", "[", 
          RowBox[{"cayley2r", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c1", "[", "t", "]"}], ",", 
             RowBox[{"c2", "[", "t", "]"}], ",", "0"}], "}"}], "]"}], "]"}], 
         ")"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Alpha]sol", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"skew2axis", "[", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"cayley2r", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], ",", 
               RowBox[{"c2", "[", "t", "]"}], ",", "0"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "2"}], "}"}]}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Transpose", "[", 
            RowBox[{"cayley2r", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], ",", 
               RowBox[{"c2", "[", "t", "]"}], ",", "0"}], "}"}], "]"}], "]"}],
            ")"}]}], "]"}], "+", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"cayley2r", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], ",", 
                RowBox[{"c2", "[", "t", "]"}], ",", "0"}], "}"}], "]"}], ",", 
             "t"}], "]"}], ")"}], ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"cayley2r", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], ",", 
                RowBox[{"c2", "[", "t", "]"}], ",", "0"}], "}"}], "]"}], ",", 
             "t"}], "]"}], "]"}]}], "]"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Omega]sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "\[Omega]x"}], ",", 
         RowBox[{
          RowBox[{"\[Omega]sol", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "\[Omega]y"}]}], "}"}], 
       "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], ",", 
        RowBox[{
         SuperscriptBox["c2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "\[Alpha]x"}], ",", 
         RowBox[{
          RowBox[{"\[Alpha]sol", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "\[Alpha]y"}]}], "}"}], 
       "\[Equal]", "0"}], ",", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c1", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], ",", " ", 
        RowBox[{
         SuperscriptBox["c2", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.675942042394044*^9, 3.675942120176927*^9}, {
  3.675942313653401*^9, 3.675942367048687*^9}, {3.675942535979056*^9, 
  3.675942544283371*^9}, {3.675942592446319*^9, 3.675942601014854*^9}, {
  3.6759450279007463`*^9, 3.675945033124681*^9}, {3.675946991838359*^9, 
  3.6759469973262157`*^9}, {3.675954498935512*^9, 3.675954537672625*^9}, {
  3.675955423672495*^9, 3.6759554531175528`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.675949169036283*^9, 3.675949268298223*^9}, {
   3.675949354056775*^9, 3.675949358016231*^9}, 3.6759554199528103`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6759493135810328`*^9, 3.675949333438452*^9}, {
   3.67594937163315*^9, 3.675949381865025*^9}, 3.675955436961948*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xc", "=", 
   RowBox[{"ra", "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c1", "^", "2"}], "-", 
       RowBox[{"c2", "^", "2"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"c1", "^", "2"}], "+", 
       RowBox[{"c2", "^", "2"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yc", "=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "ra", "*", "c1", "*", 
    RowBox[{"c2", "/", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"c1", "^", "2"}], "+", 
       RowBox[{"c2", "^", "2"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zc", "=", "z"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTp", "=", 
   RowBox[{"{", 
    RowBox[{"xc", ",", "yc", ",", "zc"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675761734114685*^9, 3.6757617458167543`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R2J\[Omega]sBody", "[", 
    RowBox[{"R_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"J\[Omega]s", ",", "n", ",", "ii"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"R2J\[Omega]s", "::", "wronginput"}], "=", 
       "\"\<`1` is not a 3x3 matrix!\>\""}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Check", " ", "to", " ", "make", " ", "sure", " ", "the", " ", 
        "dimensions", " ", "are", " ", "correct"}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MatrixQ", "[", "R", "]"}]}], "||", 
         RowBox[{
          RowBox[{"Dimensions", "[", "R", "]"}], "\[NotEqual]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}]}], ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"R2J\[Omega]s", "::", "wronginput"}], ",", "R"}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "]"}]}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"TODO", ":", 
         RowBox[{"check", " ", "for", " ", 
          RowBox[{"orthogonality", "--"}], " ", "optional"}]}], "*)"}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"J\[Omega]s", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"skew2axis", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "R", "]"}], ".", 
           RowBox[{"Simplify", "[", 
            RowBox[{"D", "[", 
             RowBox[{"R", ",", "#"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
        "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Transpose", "[", "J\[Omega]s", "]"}], "]"}], "]"}], ";"}]}], 
    "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J\[Omega]qTpBody", "=", 
   RowBox[{"R2J\[Omega]s", "[", 
    RowBox[{"RTp", ",", "q"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.675730278131709*^9, 3.675731979756439*^9, 
  3.6760353398938227`*^9, 3.676035396641416*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rotz1", "=", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"\[Pi]", "/", "3"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotz2", "=", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{
     RowBox[{"4", "*", 
      RowBox[{"\[Pi]", "/", "3"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.675732005526246*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rb", "+", 
      RowBox[{"lcr", "*", 
       RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"lst", "*", 
       RowBox[{"Cos", "[", "\[Phi]1", "]"}]}]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"lcr", "*", 
       RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
      RowBox[{"lst", "*", 
       RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"p2", " ", "=", " ", 
   RowBox[{
    RowBox[{"rotz1", ".", "p1"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "\[Rule]", " ", "\[Theta]2"}], ",", 
      RowBox[{"\[Phi]1", "\[Rule]", " ", "\[Phi]2"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p3", " ", "=", " ", 
   RowBox[{
    RowBox[{"rotz2", ".", "p1"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "\[Rule]", " ", "\[Theta]3"}], ",", 
      RowBox[{"\[Phi]1", "\[Rule]", " ", "\[Phi]3"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pc", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p1", "+", "p2", "+", "p3"}], ")"}], "/", "3"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.675732343634449*^9, 3.675732346506708*^9}, {
  3.6757323922374907`*^9, 3.6757323972857857`*^9}, {3.675732432544544*^9, 
  3.6757324459613*^9}, {3.675746808820303*^9, 3.6757468446943493`*^9}, {
  3.676085199146512*^9, 3.676085199320779*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "coordinates", " ", "of", " ", "vertices", " ", "of", " ", "top", " ", 
     "triangle", " ", "derived", " ", "from", " ", "taskspace", " ", 
     "variables"}], ",", " ", 
    RowBox[{"transformed", " ", "to", " ", "xz", " ", "plane"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1a", "=", 
     RowBox[{"pTp", "+", 
      RowBox[{"RTp", ".", 
       RowBox[{"{", 
        RowBox[{"ra", ",", "0", ",", "0"}], "}"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2a", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "rotz1", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"pTp", "+", 
         RowBox[{"RTp", ".", "rotz1", ".", 
          RowBox[{"{", 
           RowBox[{"ra", ",", "0", ",", "0"}], "}"}]}]}], ")"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3a", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "rotz2", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"pTp", "+", 
         RowBox[{"RTp", ".", "rotz2", ".", 
          RowBox[{"{", 
           RowBox[{"ra", ",", "0", ",", "0"}], "}"}]}]}], ")"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675746889570055*^9, 3.6757469114190693`*^9}, {
  3.67574732726936*^9, 3.675747433641438*^9}, {3.6759562782781467`*^9, 
  3.675956283276216*^9}, {3.676035742447382*^9, 3.6760357499504013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "coordinates", " ", "of", " ", "vertices", " ", "of", " ", "top", " ", 
     "triangle", " ", "derived", " ", "from", " ", "joint", " ", "angles"}], 
    ",", " ", 
    RowBox[{"transformed", " ", "to", " ", "xz", " ", "plane"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1b", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb", "+", 
        RowBox[{"lcr", "*", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"lst", "*", 
         RowBox[{"Cos", "[", "\[Phi]1", "]"}]}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"lcr", "*", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{"lst", "*", 
         RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"p2b", " ", "=", " ", 
     RowBox[{"p1b", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "\[Rule]", " ", "\[Theta]2"}], ",", 
        RowBox[{"\[Phi]1", "\[Rule]", " ", "\[Phi]2"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3b", " ", "=", " ", 
     RowBox[{"p1b", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "\[Rule]", " ", "\[Theta]3"}], ",", 
        RowBox[{"\[Phi]1", "\[Rule]", " ", "\[Phi]3"}]}], "}"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675747013289606*^9, 3.675747017032817*^9}, {
  3.675747061028597*^9, 3.675747110384795*^9}, {3.675747163043056*^9, 
  3.675747165269046*^9}, {3.675747441212337*^9, 3.675747460492014*^9}, {
  3.6760357173176394`*^9, 3.6760357195801487`*^9}, {3.6760852335245256`*^9, 
  3.6760852337385817`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Eta]1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{"p1a", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"p1b", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]2", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{"p1a", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"p1b", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Eta]3", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{"p2a", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"p2b", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]4", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{"p2a", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"p2b", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]5", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{"p3a", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"p3b", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]6", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Numerator", "[", 
     RowBox[{"Together", "[", 
      RowBox[{
       RowBox[{"p3a", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"p3b", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Eta]1", ",", "\[Eta]2", ",", "\[Eta]3", ",", "\[Eta]4", ",", "\[Eta]5",
      ",", "\[Eta]6"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.676084944904002*^9, 3.676084965395432*^9}, {
  3.679011985541112*^9, 3.679011992206278*^9}, {3.679015926799984*^9, 
  3.6790159397064466`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Eta]", "/.", "subsqt"}], ";"}]], "Input",
 CellChangeTimes->{{3.689474853064307*^9, 3.6894748601022387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "for", " ", "task", " ", "space", " ", "inverse", " ", "kinematics"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p11", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb", "+", 
        RowBox[{"lcr", "*", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}]}], ",", "0", ",", 
       RowBox[{"lcr", "*", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p21", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb", "+", 
        RowBox[{"lcr", "*", 
         RowBox[{"Cos", "[", "\[Theta]2", "]"}]}]}], ",", "0", ",", 
       RowBox[{"lcr", "*", 
        RowBox[{"Sin", "[", "\[Theta]2", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p31", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb", "+", 
        RowBox[{"lcr", "*", 
         RowBox[{"Cos", "[", "\[Theta]3", "]"}]}]}], ",", "0", ",", 
       RowBox[{"lcr", "*", 
        RowBox[{"Sin", "[", "\[Theta]3", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]1a", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p11", "-", "p1a"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"p11", "-", "p1a"}], ")"}]}], "-", 
      SuperscriptBox["lst", "2"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]2a", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p21", "-", "p2a"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"p21", "-", "p1a"}], ")"}]}], "-", 
      SuperscriptBox["lst", "2"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]3a", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p31", "-", "p3a"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"p31", "-", "p1a"}], ")"}]}], "-", 
      SuperscriptBox["lst", "2"]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]a", "=", 
     RowBox[{"{", 
      RowBox[{"\[Eta]1a", ",", "\[Eta]2a", ",", "\[Eta]3a"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Numerator", "[", 
      RowBox[{"Together", "[", 
       RowBox[{"\[Eta]a", "/.", "subsqt"}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6760936467285843`*^9, 3.6760936788223877`*^9}, {
  3.676093713216813*^9, 3.676093715592743*^9}, {3.676093746291374*^9, 
  3.6760938041107197`*^9}, {3.676093973321645*^9, 3.6760939848336153`*^9}, {
  3.6760957279847517`*^9, 3.676095850223473*^9}, {3.679012042049164*^9, 
  3.679012051888399*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"jacobin", " ", 
    RowBox[{"w", ".", "r", ".", "t", ".", " ", "config"}], " ", "space", " ", 
    "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"J\[Eta]q", "=", 
    RowBox[{"D", "[", 
     RowBox[{"\[Eta]", ",", 
      RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.623993199190061*^9, 3.623993209039209*^9}, 
   3.6239933916908083`*^9, {3.624012831022287*^9, 3.624012877402114*^9}, {
   3.6759563511624327`*^9, 3.675956395163986*^9}, {3.676038849375517*^9, 
   3.6760389128912973`*^9}, {3.696667115637168*^9, 3.6966671190157843`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Theta]1", ",", "\[Theta]2", ",", "\[Theta]3", ",", "\[Phi]1", ",", 
     "\[Phi]2", ",", "\[Phi]3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J\[Eta]\[Beta]", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Eta]", ",", 
      RowBox[{"{", "\[Beta]", "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"c1", "^", "2"}], "+", 
        RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], "\[Rule]", "stht1"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]2", "]"}], "\[Rule]", "stht2"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]3", "]"}], "\[Rule]", "stht3"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], "\[Rule]", "ctht1"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], "\[Rule]", "ctht2"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]3", "]"}], "\[Rule]", "ctht3"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]1", "]"}], "\[Rule]", "sgam1"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]2", "]"}], "\[Rule]", "sgam2"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]3", "]"}], "\[Rule]", "sgam3"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]1", "]"}], "\[Rule]", "cgam1"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]2", "]"}], "\[Rule]", "cgam2"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]3", "]"}], "\[Rule]", "cgam3"}], ",", 
      RowBox[{"lcr", "\[Rule]", "lCr"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.679015568688271*^9, 3.6790155768380127`*^9}, {
   3.6790156179335337`*^9, 3.679015637798435*^9}, {3.679015668268959*^9, 
   3.6790156751502247`*^9}, {3.679015735714952*^9, 3.679015832874761*^9}, {
   3.679015868684092*^9, 3.6790158748720827`*^9}, {3.679015972613604*^9, 
   3.6790159844499283`*^9}, {3.679016015247857*^9, 3.6790160693184147`*^9}, {
   3.67901621720547*^9, 3.679016307245049*^9}, {3.679017037213854*^9, 
   3.679017072122013*^9}, 3.689474928366786*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"subtht", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"c1", "[", "t", "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], "\[Rule]", "delc"}], ",",
      " ", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], "\[Rule]", "stht1"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], "\[Rule]", "stht2"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}], "\[Rule]", "stht3"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], "\[Rule]", "ctht1"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], "\[Rule]", "ctht2"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}], "\[Rule]", "ctht3"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}], "\[Rule]", "sgam1"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], "\[Rule]", "sgam2"}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}], "\[Rule]", "sgam3"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}], "\[Rule]", "cgam1"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], "\[Rule]", "cgam2"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}], "\[Rule]", "cgam3"}], ",", 
     RowBox[{
      RowBox[{"c1", "[", "t", "]"}], "\[Rule]", "c1"}], ",", 
     RowBox[{
      RowBox[{"c2", "[", "t", "]"}], "\[Rule]", "c2"}], ",", 
     RowBox[{
      RowBox[{"z", "[", "t", "]"}], "\[Rule]", "z"}], ",", 
     RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
     RowBox[{"lst", "\[Rule]", "lSt"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dsubs", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"c1", "'"}], "[", "t", "]"}], "\[Rule]", "dc1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c2", "'"}], "[", "t", "]"}], "\[Rule]", "dc2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c3", "'"}], "[", "t", "]"}], "\[Rule]", "dc3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", "dtht1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}], "\[Rule]", "dtht2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]3", "'"}], "[", "t", "]"}], "\[Rule]", "dtht3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]1", "'"}], "[", "t", "]"}], "\[Rule]", "dgam1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]2", "'"}], "[", "t", "]"}], "\[Rule]", "dgam2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]3", "'"}], "[", "t", "]"}], "\[Rule]", "dgam3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "'"}], "[", "t", "]"}], "\[Rule]", "dz"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.679018554321199*^9, 3.679018631871039*^9}, {
  3.679018831164139*^9, 3.6790190744051523`*^9}, {3.679019280448002*^9, 
  3.679019283319133*^9}, {3.6790195935297422`*^9, 3.679019646896356*^9}, {
  3.6894749389253197`*^9, 3.6894749484764*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J\[Eta]\[Beta]", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Eta]", ",", 
      RowBox[{"{", "\[Beta]", "}"}]}], "]"}], "/.", "subsqt"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dJ\[Eta]\[Beta]", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"J\[Eta]\[Beta]", ",", "t"}], "]"}], "/.", "subtht"}], "/.", 
    "dsubs"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679018482925661*^9, 3.67901854297087*^9}, {
   3.679018577222047*^9, 3.67901857994359*^9}, {3.679018917222725*^9, 
   3.67901891939213*^9}, 3.689474975195901*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J\[Eta]X", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Eta]", ",", 
      RowBox[{"{", "X", "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"c1", "^", "2"}], "+", 
        RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]1", "]"}], "\[Rule]", "stht1"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]2", "]"}], "\[Rule]", "stht2"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]3", "]"}], "\[Rule]", "stht3"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]1", "]"}], "\[Rule]", "ctht1"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], "\[Rule]", "ctht2"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]3", "]"}], "\[Rule]", "ctht3"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]1", "]"}], "\[Rule]", "sgam1"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]2", "]"}], "\[Rule]", "sgam2"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Phi]3", "]"}], "\[Rule]", "sgam3"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]1", "]"}], "\[Rule]", "cgam1"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]2", "]"}], "\[Rule]", "cgam2"}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]3", "]"}], "\[Rule]", "cgam3"}], ",", 
      RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
      RowBox[{
       RowBox[{"Sqrt", "[", "3", "]"}], "\[Rule]", "sqrt3"}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.679017333003666*^9, 3.679017435075779*^9}, {
   3.679017479117338*^9, 3.679017520692677*^9}, 3.689475044941327*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "given", " ", "2", " ", "vectors", " ", "V1", " ", "and", " ", "V2", " ", 
     "and", " ", "their", " ", "corresponding", " ", "transformed", " ", 
     "vectors", " ", "v1", " ", "and", " ", "v2"}], ",", " ", 
    RowBox[{
    "the", " ", "following", " ", "function", " ", "returns", " ", "a", " ", 
     "Rotation", " ", "matrix", " ", "which", " ", "brings", " ", "about", 
     " ", "this", " ", "transformation"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rotMat2vec", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V1_", ",", "V2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v1_", ",", "v2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "norm", ",", "crossV", ",", "crossv", ",", "S", ",", "M", ",", "s", 
        ",", "m", ",", "A"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"norm", "[", "a_", "]"}], ":=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"V1", "/", 
         RowBox[{"norm", "[", "V1", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"v1", "/", 
         RowBox[{"norm", "[", "v1", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"crossV", "=", 
        RowBox[{"Cross", "[", 
         RowBox[{"V1", ",", "V2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"crossV", "/", 
         RowBox[{"norm", "[", "crossV", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"crossv", "=", 
        RowBox[{"Cross", "[", 
         RowBox[{"v1", ",", "v2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"crossv", "/", 
         RowBox[{"norm", "[", "crossv", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"S", ",", "M", ",", 
            RowBox[{"Cross", "[", 
             RowBox[{"S", ",", "M"}], "]"}]}], "}"}], "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"s", ",", "m", ",", 
           RowBox[{"Cross", "[", 
            RowBox[{"s", ",", "m"}], "]"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "A", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.623853157561762*^9, 3.623853177750243*^9}, {
  3.675748787782118*^9, 3.675748916845099*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "S", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "   ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Crank", " ", "length"}], "              ", "=", " ", "lcr"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"base", " ", "circumradius"}], "         ", "=", " ", "rb"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"top", " ", "platform", " ", "circumradius"}], " ", "=", " ", 
     "ra"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Strut", " ", "length"}], "              ", "=", " ", "lst"}]}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.675748370643681*^9, 3.6757484520959997`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1c", "=", 
   RowBox[{"p1", "-", "pc"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2c", "=", 
   RowBox[{"p2", "-", "pc"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "position", " ", "of", " ", "center", " ", "of", " ", "mass", " ", "of", 
    " ", "the", " ", "cranks"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pCr1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb", "+", 
        RowBox[{
         RowBox[{"lcr", "/", "2"}], "*", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"lcr", "/", "2"}], "*", 
        RowBox[{"Sin", "[", "\[Theta]1", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pCr2", "=", 
     RowBox[{
      RowBox[{"rotz1", ".", "pCr1"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "\[Rule]", " ", "\[Theta]2"}], ",", 
        RowBox[{"\[Phi]1", "\[Rule]", " ", "\[Phi]2"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pCr3", "=", 
     RowBox[{
      RowBox[{"rotz2", ".", "pCr1"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "\[Rule]", " ", "\[Theta]3"}], ",", 
        RowBox[{"\[Phi]1", "\[Rule]", " ", "\[Phi]3"}]}], "}"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675754215460868*^9, 3.675754241357985*^9}, {
  3.67575428487346*^9, 3.6757543437240677`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "linear", " ", "velocity", " ", "jacobian", " ", "for", " ", "crank", " ", 
    
    RowBox[{"C", ".", "O", ".", "M", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JvCr1", "=", 
     RowBox[{"D", "[", 
      RowBox[{"pCr1", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"JvCr2", "=", 
     RowBox[{"D", "[", 
      RowBox[{"pCr2", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"JvCr3", "=", 
     RowBox[{"D", "[", 
      RowBox[{"pCr3", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675956860170144*^9, 3.675956866832478*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "position", " ", "of", " ", "center", " ", "of", " ", "mass", " ", "of", 
    " ", "strut"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pSt1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb", "+", 
        RowBox[{"lcr", "*", 
         RowBox[{"Cos", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"lst", "/", "2"}], "*", 
         RowBox[{"Cos", "[", "\[Phi]1", "]"}]}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"lcr", "*", 
         RowBox[{"Sin", "[", "\[Theta]1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"lst", "/", "2"}], "*", 
         RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pSt2", "=", 
     RowBox[{
      RowBox[{"rotz1", ".", "pSt1"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "\[Rule]", " ", "\[Theta]2"}], ",", 
        RowBox[{"\[Phi]1", "\[Rule]", " ", "\[Phi]2"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pSt3", "=", 
     RowBox[{
      RowBox[{"rotz2", ".", "pSt1"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "\[Rule]", " ", "\[Theta]3"}], ",", 
        RowBox[{"\[Phi]1", "\[Rule]", " ", "\[Phi]3"}]}], "}"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675754389711335*^9, 3.675754426560861*^9}, {
   3.675756192454154*^9, 3.67575627566648*^9}, {3.675756312749906*^9, 
   3.6757563131333113`*^9}, 3.689475123228793*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "linear", " ", "velocity", " ", "jacobian", " ", "for", " ", "strut", " ", 
    
    RowBox[{"C", ".", "O", ".", "M", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JvSt1", "=", 
     RowBox[{"D", "[", 
      RowBox[{"pSt1", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"JvSt2", "=", 
     RowBox[{"D", "[", 
      RowBox[{"pSt2", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"JvSt3", "=", 
     RowBox[{"D", "[", 
      RowBox[{"pSt3", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67595681067908*^9, 3.675956845432207*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "linear", " ", "velocity", " ", "jacobian", " ", "for", " ", "centroid", 
    " ", "of", " ", "top", " ", "platform"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"JvTp", "=", 
    RowBox[{"D", "[", 
     RowBox[{"pTp", ",", 
      RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.675756478672357*^9, 3.675756501801908*^9}, {
   3.675956879115034*^9, 3.675956880570807*^9}, {3.675956926173209*^9, 
   3.6759569355415697`*^9}, 3.6894972233965197`*^9, {3.689497393525029*^9, 
   3.68949739465099*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"co", "-", 
    RowBox[{"ordinates", " ", "of", " ", "payloads"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"pPl", "=", 
    RowBox[{"pTp", " ", "+", " ", 
     RowBox[{"RTp", ".", 
      RowBox[{"{", 
       RowBox[{"xPl", ",", "yPl", ",", "zPl"}], "}"}]}]}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.6757565359395323`*^9, 3.675756536742374*^9}, {
   3.675756751153367*^9, 3.675756839142396*^9}, {3.675756877761183*^9, 
   3.6757569626225243`*^9}, {3.679039787520314*^9, 3.679039854596224*^9}, {
   3.6894751609844847`*^9, 3.689475205095414*^9}, {3.6894958057297497`*^9, 
   3.689495819801355*^9}, 3.689497098271867*^9, 3.689497684707594*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "linear", " ", "velocity", " ", "jacobian", " ", "for", " ", "centroid", 
    " ", "of", " ", "top", " ", "platform", " ", "and", " ", "payload", " ", 
    RowBox[{"C", ".", "O", ".", "M", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JvPl", "=", 
     RowBox[{"D", "[", 
      RowBox[{"pPl", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6757569838319197`*^9, 3.675757007065926*^9}, {
   3.6759569678641663`*^9, 3.675956989633111*^9}, {3.6894752124727983`*^9, 
   3.689475223383565*^9}, {3.689495826504754*^9, 3.689495838959566*^9}, {
   3.689495901134659*^9, 3.689495901737914*^9}, 3.689497103966135*^9, 
   3.689497686741212*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]Cr1", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Theta]1", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]Cr2", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Theta]2", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]Cr3", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Theta]3", ",", "0"}], "}"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "angular", " ", "velocity", " ", "jacobian", " ", "for", " ", "crank", " ",
     "angles"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"J\[Omega]Cr1", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Theta]Cr1", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J\[Omega]Cr2", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Theta]Cr2", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J\[Omega]Cr3", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Theta]Cr3", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.6757571023910503`*^9, {3.675757142930077*^9, 3.675757149961302*^9}, {
   3.675957014835497*^9, 3.675957035475367*^9}, {3.689475296470943*^9, 
   3.689475336357394*^9}, {3.6894753855934362`*^9, 3.689475386745088*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]St1", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Phi]1", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]St2", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Phi]2", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]St3", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Phi]3", ",", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675757190460383*^9, 3.675757198484932*^9}, {
  3.6894753906074257`*^9, 3.6894754016274157`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "angular", " ", "velocity", " ", "jacobian", " ", "for", " ", "strut", " ",
     "angles"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"J\[Omega]St1", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Theta]St1", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J\[Omega]St2", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Theta]St2", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J\[Omega]St3", "=", 
     RowBox[{"D", "[", 
      RowBox[{"\[Theta]St3", ",", 
       RowBox[{"{", "q", "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675757226622572*^9, 3.675757237134611*^9}, {
  3.675957051621591*^9, 3.6759570600134163`*^9}, {3.676039070508847*^9, 
  3.676039076477532*^9}, {3.68947540365121*^9, 3.6894754072651167`*^9}}],

Cell[BoxData[
 RowBox[{"J\[Omega]qTpBody", ";"}]], "Input",
 CellChangeTimes->{
  3.675757256728242*^9, {3.675757295923657*^9, 3.6757573008096523`*^9}, 
   3.675757477479388*^9, {3.675957114329061*^9, 3.675957126256206*^9}, {
   3.6760390959016743`*^9, 3.676039100325959*^9}, {3.6760397137173443`*^9, 
   3.676039717957066*^9}, {3.689475409438033*^9, 3.689475424828123*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "mass", " ", "moment", " ", "of", " ", "inertia", " ", "matrices"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ICr", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ICrx", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "ICry", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "ICrz"}], "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ISt", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"IStx", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "ISty", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "IStz"}], "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ITp", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ITpx", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "ITpy", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "ITpz"}], "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"IPl", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"IPlx", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "IPly", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "IPlz"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675757517937772*^9, 3.675757529897238*^9}, {
   3.675758482227828*^9, 3.675758485971818*^9}, {3.675957148099681*^9, 
   3.67595716399586*^9}, 3.67595956943398*^9, 3.676039811819536*^9, 
   3.676040184306148*^9, 3.6760402547747793`*^9, 3.676040294042718*^9, 
   3.676040411352528*^9, {3.67903991445366*^9, 3.6790399416270657`*^9}, {
   3.689475433387252*^9, 3.6894754765185738`*^9}, {3.689495851241091*^9, 
   3.689495874379238*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mass", " ", "matrices"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Mleg1", "=", 
     RowBox[{
      RowBox[{"mCr", "*", 
       RowBox[{
        RowBox[{"Transpose", "[", "JvCr1", "]"}], ".", "JvCr1"}]}], "+", 
      RowBox[{
       RowBox[{"Transpose", "[", "J\[Omega]Cr1", "]"}], ".", "ICr", ".", 
       "J\[Omega]Cr1"}], "+", 
      RowBox[{"mSt", "*", 
       RowBox[{
        RowBox[{"Transpose", "[", "JvSt1", "]"}], ".", "JvSt1"}]}], "+", 
      RowBox[{
       RowBox[{"Transpose", "[", "J\[Omega]St1", "]"}], ".", "ISt", ".", 
       "J\[Omega]St1"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mleg2", "=", 
     RowBox[{
      RowBox[{"mCr", "*", 
       RowBox[{
        RowBox[{"Transpose", "[", "JvCr2", "]"}], ".", "JvCr2"}]}], "+", 
      RowBox[{
       RowBox[{"Transpose", "[", "J\[Omega]Cr2", "]"}], ".", "ICr", ".", 
       "J\[Omega]Cr2"}], "+", 
      RowBox[{"mSt", "*", 
       RowBox[{
        RowBox[{"Transpose", "[", "JvSt2", "]"}], ".", "JvSt2"}]}], "+", 
      RowBox[{
       RowBox[{"Transpose", "[", "J\[Omega]St2", "]"}], ".", "ISt", ".", 
       "J\[Omega]St2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mleg3", "=", 
     RowBox[{
      RowBox[{"mCr", "*", 
       RowBox[{
        RowBox[{"Transpose", "[", "JvCr3", "]"}], ".", "JvCr3"}]}], "+", 
      RowBox[{
       RowBox[{"Transpose", "[", "J\[Omega]Cr3", "]"}], ".", "ICr", ".", 
       "J\[Omega]Cr3"}], "+", 
      RowBox[{"mSt", "*", 
       RowBox[{
        RowBox[{"Transpose", "[", "JvSt3", "]"}], ".", "JvSt3"}]}], "+", 
      RowBox[{
       RowBox[{"Transpose", "[", "J\[Omega]St3", "]"}], ".", "ISt", ".", 
       "J\[Omega]St3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MTp", "=", 
     RowBox[{
      RowBox[{"mTp", "*", 
       RowBox[{
        RowBox[{"Transpose", "[", "JvTp", "]"}], ".", "JvTp"}]}], "+", 
      RowBox[{
       RowBox[{"Transpose", "[", "J\[Omega]qTpBody", "]"}], ".", "ITp", ".", 
       "J\[Omega]qTpBody"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MPl", "=", 
     RowBox[{
      RowBox[{"mPl", "*", 
       RowBox[{
        RowBox[{"Transpose", "[", "JvPl", "]"}], ".", "JvPl"}]}], "+", 
      RowBox[{
       RowBox[{"Transpose", "[", "J\[Omega]qTpBody", "]"}], ".", "IPl", ".", 
       "J\[Omega]qTpBody"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "mass", " ", "matrix", " ", "for", " ", "the", " ", "manipulator"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mq3RRS", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Mleg1", "+", "Mleg2", "+", "Mleg3", "+", "MTp", "+", "MPl"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675758303503067*^9, 3.6757583130813293`*^9}, {
   3.679012606814579*^9, 3.679012643693252*^9}, 3.6790263636515503`*^9, {
   3.679026925635871*^9, 3.679026950495743*^9}, {3.6790270488597116`*^9, 
   3.6790270548497543`*^9}, {3.6790271234822483`*^9, 3.679027139315976*^9}, {
   3.6790271752496557`*^9, 3.6790272140217657`*^9}, 3.679028128025977*^9, {
   3.679028175794599*^9, 3.67902821106989*^9}, {3.679028277898388*^9, 
   3.679028285713458*^9}, 3.679029084715309*^9, {3.679029123814324*^9, 
   3.6790291608567133`*^9}, 3.679036652993794*^9, {3.679039982074092*^9, 
   3.6790400352905617`*^9}, 3.679041246606289*^9, 3.679196272836627*^9, 
   3.679196509895162*^9, {3.689475562341852*^9, 3.689475596718513*^9}, {
   3.689495884388002*^9, 3.6894959155726357`*^9}, 3.6894970331340017`*^9, 
   3.689497691691567*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J\[Eta]\[Theta]", "=", 
   RowBox[{"D", "[", 
    RowBox[{"\[Eta]", ",", 
     RowBox[{"{", "\[Theta]", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J\[Eta]\[Phi]", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Eta]", ",", 
      RowBox[{"{", "\[Phi]", "}"}]}], "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.679100212499473*^9, 3.679100258814098*^9}, 
   3.6791965252755413`*^9, {3.689476066841908*^9, 3.689476071370268*^9}, {
   3.689476191944034*^9, 3.689476192493454*^9}, {3.6966672019859953`*^9, 
   3.696667209078784*^9}, {3.696667266826847*^9, 3.6966673047601967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"J\[Eta]\[Phi]inv", "=", 
     RowBox[{"Inverse", "[", "J\[Eta]\[Phi]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"J\[Phi]\[Theta]", "=", 
    RowBox[{"-", 
     RowBox[{"J\[Eta]\[Phi]inv", ".", "J\[Eta]\[Theta]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.696667217686397*^9, 3.696667256854789*^9}, {
  3.696667324580456*^9, 3.696667442493786*^9}, {3.6966676635107517`*^9, 
  3.696667668566411*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jq\[Theta]", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", "J\[Phi]\[Theta]"}], 
     "]"}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.696667921099489*^9, 3.696668034525242*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"computation", " ", "of", " ", "C", " ", "matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CmfromM", "[", 
     RowBox[{"massMatrix_", ",", "q_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "dMdq", ",", "count", ",", "ii", ",", "jj", ",", "kk", ",", 
        "querydMdq", ",", "cmat"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "q", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dMdq", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], ",", "n"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"count", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<yes\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "\[LessEqual]", "n"}], ",", 
         RowBox[{"ii", "++"}], ",", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "\[LessEqual]", "ii"}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"dMdq", "[", 
               RowBox[{"[", "count", "]"}], "]"}], "=", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"massMatrix", "[", 
                 RowBox[{"[", 
                  RowBox[{"ii", ",", "jj"}], "]"}], "]"}], ",", 
                RowBox[{"{", "q", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"count", "++"}], ";"}]}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"querydMdq", "[", 
         RowBox[{"ii_", ",", "jj_", ",", "kk_"}], "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", ">", "jj"}], ",", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"dMdq", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"ii", "-", "1"}], ")"}], "*", 
                 RowBox[{"ii", "/", "2"}]}], "+", "jj"}], ",", "kk"}], "]"}], 
             "]"}], "]"}], ";"}], ",", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"dMdq", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"jj", "-", "1"}], ")"}], "*", 
                 RowBox[{"jj", "/", "2"}]}], "+", "ii"}], ",", "kk"}], "]"}], 
             "]"}], "]"}], ";"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cmat", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "\[LessEqual]", "n"}], ",", 
         RowBox[{"ii", "++"}], ",", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "\[LessEqual]", "n"}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"kk", "=", "1"}], ",", 
               RowBox[{"kk", "\[LessEqual]", "n"}], ",", 
               RowBox[{"kk", "++"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"cmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "+=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"querydMdq", "[", 
                    RowBox[{"ii", ",", "jj", ",", "kk"}], "]"}], "+", 
                    RowBox[{"querydMdq", "[", 
                    RowBox[{"ii", ",", "kk", ",", "jj"}], "]"}], "-", 
                    RowBox[{"querydMdq", "[", 
                    RowBox[{"kk", ",", "jj", ",", "ii"}], "]"}]}], ")"}], "*", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"q", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], ",", "t"}], "]"}]}]}], 
                ";"}]}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cmat", "=", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "*", "cmat"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<yes\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cmat", "]"}], ";"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6235143130418262`*^9, 3.62351431304244*^9}, 
   3.6240273199455013`*^9, {3.675759174700993*^9, 3.675759197197945*^9}, {
   3.6760414824211473`*^9, 3.676041482882077*^9}, 3.6790126542227573`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Coriolis", " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Cq3RRSt", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"CmfromM", "[", 
      RowBox[{
       RowBox[{"Mq3RRS", "/.", "subsqt"}], ",", 
       RowBox[{"q", "/.", "subsqt"}]}], "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.623514322673568*^9, 3.623514350316845*^9}, {
   3.62351446091533*^9, 3.623514493175709*^9}, {3.623514785089539*^9, 
   3.623514794152919*^9}, {3.623514908844488*^9, 3.6235149249186*^9}, {
   3.623515542037025*^9, 3.623515542527622*^9}, 3.623855998903013*^9, {
   3.623863738037372*^9, 3.623863741327469*^9}, {3.623921440680485*^9, 
   3.6239214440174637`*^9}, {3.623947396291548*^9, 3.62394739980444*^9}, {
   3.6240141680858927`*^9, 3.62401416952621*^9}, 3.624027183625661*^9, {
   3.624029664784793*^9, 3.624029680098527*^9}, {3.624029720493376*^9, 
   3.624029722054295*^9}, 3.6240299460003347`*^9, {3.624200502545846*^9, 
   3.624200508510934*^9}, 3.634459319557272*^9, 3.634459473155384*^9, 
   3.63454936520389*^9, {3.675759329622869*^9, 3.675759333469186*^9}, 
   3.675761178536058*^9, {3.6757613334264097`*^9, 3.6757613370570307`*^9}, {
   3.689476205293742*^9, 3.689476212173452*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"yes\"\>"], "Print",
 CellChangeTimes->{
  3.675759282437563*^9, {3.675759336074841*^9, 3.675759363856818*^9}, 
   3.675761179985153*^9, 3.6757613429466457`*^9, 3.675761797918041*^9, 
   3.6757734189790363`*^9, 3.675789013914175*^9, 3.675953981488674*^9, 
   3.6760528446892443`*^9, 3.676058119417912*^9, 3.676058431659737*^9, 
   3.6760852582382803`*^9, 3.676096563251243*^9, 3.679012678212967*^9, {
   3.67904231484516*^9, 3.67904233958937*^9}, 3.679099479221944*^9, 
   3.6791955036008787`*^9, 3.679462320991482*^9, 3.6894758501986027`*^9, {
   3.689476201136504*^9, 3.68947622042205*^9}, {3.6894764091978073`*^9, 
   3.689476426356618*^9}, 3.6894959404086037`*^9, 3.6895569622729597`*^9, 
   3.689582371810644*^9, 3.6896412595696707`*^9, 3.6966671930357924`*^9}],

Cell[BoxData["\<\"yes\"\>"], "Print",
 CellChangeTimes->{
  3.675759282437563*^9, {3.675759336074841*^9, 3.675759363856818*^9}, 
   3.675761179985153*^9, 3.6757613429466457`*^9, 3.675761797918041*^9, 
   3.6757734189790363`*^9, 3.675789013914175*^9, 3.675953981488674*^9, 
   3.6760528446892443`*^9, 3.676058119417912*^9, 3.676058431659737*^9, 
   3.6760852582382803`*^9, 3.676096563251243*^9, 3.679012678212967*^9, {
   3.67904231484516*^9, 3.67904233958937*^9}, 3.679099479221944*^9, 
   3.6791955036008787`*^9, 3.679462320991482*^9, 3.6894758501986027`*^9, {
   3.689476201136504*^9, 3.68947622042205*^9}, {3.6894764091978073`*^9, 
   3.689476426356618*^9}, 3.6894959404086037`*^9, 3.6895569622729597`*^9, 
   3.689582371810644*^9, 3.6896412595696707`*^9, 3.6966671930572357`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vsystem", "=", 
   RowBox[{"g", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mCr", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pCr1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{"pCr2", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{"pCr3", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"mSt", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pSt1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{"pSt2", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", 
         RowBox[{"pSt3", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "+", 
      RowBox[{"mTp", "*", 
       RowBox[{"pTp", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "+", 
      RowBox[{"mPl", "*", 
       RowBox[{"pPl", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gq3RRS", "=", 
   RowBox[{"D", "[", 
    RowBox[{"Vsystem", ",", 
     RowBox[{"{", "q", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6235153150792637`*^9, 3.623515523685749*^9}, {
   3.6239319537317038`*^9, 3.623931976555376*^9}, 3.6239805071258383`*^9, {
   3.624015829583159*^9, 3.624015837741008*^9}, {3.6240172866188803`*^9, 
   3.624017298477209*^9}, 3.624193453600586*^9, {3.624193598139337*^9, 
   3.624193617774042*^9}, 3.624207741251397*^9, {3.6757615172452593`*^9, 
   3.675761518709238*^9}, {3.6790127367759542`*^9, 3.6790127416285067`*^9}, {
   3.679045909342375*^9, 3.679045915982045*^9}, {3.679046045162318*^9, 
   3.679046059533947*^9}, {3.679046126749886*^9, 3.679046157810279*^9}, 
   3.6790462202460938`*^9, {3.6790462556895227`*^9, 3.679046256536284*^9}, {
   3.679197239996117*^9, 3.6791974055741253`*^9}, 3.689476228450322*^9, {
   3.689476260890292*^9, 3.689476274510647*^9}, {3.689495972158381*^9, 
   3.689495978613546*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{"TrigExpand", "[", 
    RowBox[{"Mq3RRS", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mCr", "\[Rule]", "6.111"}], ",", 
       RowBox[{"mSt", "\[Rule]", "17.05"}], ",", " ", 
       RowBox[{"mTp", "\[Rule]", "27.1855"}], ",", 
       RowBox[{"mPl", "\[Rule]", "200"}], ",", 
       RowBox[{"xPl", "\[Rule]", "0.1"}], ",", 
       RowBox[{"yPl", "\[Rule]", "0"}], ",", " ", 
       RowBox[{"zPl", "\[Rule]", "0.465"}], ",", 
       RowBox[{"lst", "\[Rule]", "0.538"}], ",", 
       RowBox[{"lcr", "\[Rule]", "0.322"}], ",", " ", 
       RowBox[{"rb", "\[Rule]", "0.307"}], ",", 
       RowBox[{"rt", "\[Rule]", "0.677"}], ",", 
       RowBox[{"ICry", "\[Rule]", "0.0559"}], ",", 
       RowBox[{"ISty", "\[Rule]", "0.435"}], ",", 
       RowBox[{"ITpx", "\[Rule]", "6.2520"}], ",", 
       RowBox[{"ITpy", "\[Rule]", "6.2520"}], ",", 
       RowBox[{"ITpz", "\[Rule]", "12.5034"}], ",", 
       RowBox[{"IPlx", "\[Rule]", "86.265"}], ",", 
       RowBox[{"IPly", "\[Rule]", "98.580"}], ",", 
       RowBox[{"IPlz", "\[Rule]", "50.977"}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"-", "0.754983"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"-", "0.754983"}]}], ",", 
     RowBox[{"\[Theta]3", "\[Rule]", 
      RowBox[{"-", "0.754983"}]}], ",", 
     RowBox[{"\[Phi]1", "\[Rule]", "1.31621"}], ",", 
     RowBox[{"\[Phi]2", "\[Rule]", "1.31621"}], ",", 
     RowBox[{"\[Phi]3", "\[Rule]", "1.31621"}], ",", 
     RowBox[{"c1", "\[Rule]", "0"}], ",", 
     RowBox[{"c2", "\[Rule]", "0"}], ",", 
     RowBox[{"z", "\[Rule]", "0.3"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.6896412662335873`*^9, 3.689641270894661*^9}, {
  3.689641370635666*^9, 3.6896416037313967`*^9}, {3.68964163551729*^9, 
  3.689641747888074*^9}, {3.689641930559572*^9, 3.689642062810923*^9}, {
  3.6966690428720293`*^9, 3.696669047246724*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.9821154310000004`", ",", "0", ",", "0", ",", 
     RowBox[{"-", "0.7085473773390163`"}], ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1.9821154310000004`", ",", "0", ",", "0", ",", 
     RowBox[{"-", "0.7085473773390163`"}], ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1.9821154310000004`", ",", "0", ",", "0", ",", 
     RowBox[{"-", "0.7085473773390163`"}], ",", "0", ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7085473773390163`"}], ",", "0", ",", "0", ",", 
     "1.6687550500000004`", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "0.7085473773390163`"}], ",", "0", ",", "0", ",", 
     "1.6687550500000004`", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "0.7085473773390163`"}], ",", "0", ",", "0", ",", 
     "1.6687550500000004`", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "543.048`", 
     ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.`", ",", 
     "600.308`", ",", 
     RowBox[{"-", "40.`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.`", ",", 
     RowBox[{"-", "40.`"}], ",", "227.1855`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.689641388014901*^9, {3.689641445203472*^9, 3.689641470036726*^9}, 
   3.68964150319037*^9, {3.6896415383847713`*^9, 3.689641604287198*^9}, {
   3.689641644484333*^9, 3.689641661283215*^9}, {3.689641695977315*^9, 
   3.6896417482672462`*^9}, 3.689641944717709*^9, 3.6896419948739977`*^9, {
   3.689642036054495*^9, 3.689642076366523*^9}, {3.696669034071369*^9, 
   3.696669047876157*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mq3RRS", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
          RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
          RowBox[{"ra", "\[Rule]", "rt"}], ",", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"c1", "^", "2"}], "+", 
            RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
       RowBox[{
       "\"\<Cos(\[Theta]1 - \[Phi]1)\>\"", "\[Rule]", "\"\<cthphi1\>\""}]}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<pow(lCr,2)\>\"", "\[Rule]", "\"\<lCrsqr\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689476454097322*^9, 3.689476461860388*^9}, {
  3.689476539620285*^9, 3.6894765516241293`*^9}, {3.6894769628276377`*^9, 
  3.6894770186192102`*^9}, {3.689477064346744*^9, 3.689477152143873*^9}, {
  3.689477186841241*^9, 3.6894773153129683`*^9}, {3.689477401384008*^9, 
  3.689477429845408*^9}, {3.689478372067635*^9, 3.6894784017100563`*^9}}],

Cell[BoxData["\<\"List(ICry + (lCrsqr*(mCr + \
4*mSt))/4.,0,0,(lCr*lSt*mSt*cthphi1)/2.,0,0,0,0,0)\"\>"], "Output",
 CellChangeTimes->{
  3.689478402039139*^9, {3.689495992730607*^9, 3.689495995335678*^9}, 
   3.689496164161071*^9, 3.689557288994347*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mq3RRS", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
          RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
          RowBox[{"ra", "\[Rule]", "rt"}], ",", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"c1", "^", "2"}], "+", 
            RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
       RowBox[{
       "\"\<Cos(\[Theta]2 - \[Phi]2)\>\"", "\[Rule]", "\"\<cthphi2\>\""}]}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<pow(lCr,2)\>\"", "\[Rule]", "\"\<lCrsqr\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689477440761559*^9, 3.6894774520348*^9}, {
  3.689478447269725*^9, 3.6894784544893923`*^9}}],

Cell[BoxData["\<\"List(0,ICry + (lCrsqr*(mCr + \
4*mSt))/4.,0,0,(lCr*lSt*mSt*cthphi2)/2.,0,0,0,0)\"\>"], "Output",
 CellChangeTimes->{{3.689477436287675*^9, 3.6894774525106688`*^9}, 
   3.689478458943468*^9, 3.68949604044284*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mq3RRS", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
          RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
          RowBox[{"ra", "\[Rule]", "rt"}], ",", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"c1", "^", "2"}], "+", 
            RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
       RowBox[{
       "\"\<Cos(\[Theta]3 - \[Phi]3)\>\"", "\[Rule]", "\"\<cthphi3\>\""}]}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<pow(lCr,2)\>\"", "\[Rule]", "\"\<lCrsqr\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689477494445043*^9, 3.6894775018716497`*^9}, {
  3.689478449628831*^9, 3.6894784573249073`*^9}}],

Cell[BoxData["\<\"List(0,0,ICry + (lCrsqr*(mCr + \
4*mSt))/4.,0,0,(lCr*lSt*mSt*cthphi3)/2.,0,0,0)\"\>"], "Output",
 CellChangeTimes->{3.689477502161593*^9, 3.689478460266962*^9, 
  3.6894961278251543`*^9, 3.689496159735965*^9, 3.689642203669141*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mq3RRS", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
          RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
          RowBox[{"ra", "\[Rule]", "rt"}], ",", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"c1", "^", "2"}], "+", 
            RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
       RowBox[{
       "\"\<Cos(\[Theta]1 - \[Phi]1)\>\"", "\[Rule]", "\"\<cthphi1\>\""}]}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<pow(lSt,2)\>\"", "\[Rule]", "\"\<lStsqr\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689477544114793*^9, 3.6894775619874477`*^9}, 
   3.689477631611596*^9, {3.689478505747674*^9, 3.6894785282658463`*^9}}],

Cell[BoxData["\<\"List((lCr*lSt*mSt*cthphi1)/2.,0,0,ISty + \
(lStsqr*mSt)/4.,0,0,0,0,0)\"\>"], "Output",
 CellChangeTimes->{{3.689477546055128*^9, 3.689477562292226*^9}, 
   3.689477631899098*^9, 3.689478534949779*^9, 3.689496182103282*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mq3RRS", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
          RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
          RowBox[{"ra", "\[Rule]", "rt"}], ",", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"c1", "^", "2"}], "+", 
            RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
       RowBox[{
       "\"\<Cos(\[Theta]2 - \[Phi]2)\>\"", "\[Rule]", "\"\<cthphi2\>\""}]}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<pow(lSt,2)\>\"", "\[Rule]", "\"\<lStsqr\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6894776591710653`*^9, 3.689477666090361*^9}, {
  3.689478519084735*^9, 3.689478530750154*^9}}],

Cell[BoxData["\<\"List(0,(lCr*lSt*mSt*cthphi2)/2.,0,0,ISty + \
(lStsqr*mSt)/4.,0,0,0,0)\"\>"], "Output",
 CellChangeTimes->{
  3.689477666461487*^9, {3.68947853581067*^9, 3.689478559803421*^9}, 
   3.6894962141143093`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Mq3RRS", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
          RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
          RowBox[{"ra", "\[Rule]", "rt"}], ",", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"c1", "^", "2"}], "+", 
            RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
       RowBox[{
       "\"\<Cos(\[Theta]3 - \[Phi]3)\>\"", "\[Rule]", "\"\<cthphi3\>\""}]}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<pow(lSt,2)\>\"", "\[Rule]", "\"\<lStsqr\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.68947769399079*^9, 3.6894777008261127`*^9}, {
  3.68947852240177*^9, 3.689478532507016*^9}}],

Cell[BoxData["\<\"List(0,0,(lCr*lSt*mSt*cthphi3)/2.,0,0,ISty + \
(lStsqr*mSt)/4.,0,0,0)\"\>"], "Output",
 CellChangeTimes->{3.6894777027214317`*^9, 3.689478536693138*^9, 
  3.689478575757907*^9, 3.689496130963606*^9, 3.689496225658146*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"CForm", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mq3RRS", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
           RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
           RowBox[{"ra", "\[Rule]", "rt"}], ",", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"c1", "^", "2"}], "+", 
             RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], 
        "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], "}"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pow(c1,2)\>\"", "\[Rule]", "\"\<c1sqr\>\""}], ",", 
      RowBox[{"\"\<pow(c2,2)\>\"", "\[Rule]", "\"\<c2sqr\>\""}], ",", 
      RowBox[{"\"\<pow(xPl,2)\>\"", "\[Rule]", "\"\<xPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(yPl,2)\>\"", "\[Rule]", "\"\<yPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(zPl,2)\>\"", "\[Rule]", "\"\<zPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(rt,2)\>\"", "\[Rule]", "\"\<rtsqr\>\""}], ",", 
      RowBox[{"\"\<pow(delc,2)\>\"", "\[Rule]", "\"\<delcsqr\>\""}], ",", 
      RowBox[{"\"\<pow(c1,4)\>\"", "\[Rule]", "\"\<c1pow4\>\""}], ",", 
      RowBox[{"\"\<pow(c2,4)\>\"", "\[Rule]", "\"\<c2pow4\>\""}]}], "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.689477733648844*^9, 3.689477779982543*^9}, 
   3.689477820116516*^9, {3.689477864962006*^9, 3.689477909287096*^9}, 
   3.689477954369473*^9, {3.689478022006669*^9, 3.6894782683320837`*^9}, {
   3.6894786080829477`*^9, 3.6894786391532087`*^9}, {3.6894786700304403`*^9, 
   3.689478686549899*^9}, {3.689478857909623*^9, 3.689478863986216*^9}, 
   3.689478951809421*^9, 3.68949623570448*^9, {3.689496314279541*^9, 
   3.689496335560629*^9}, 3.689496388978937*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"CForm", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mq3RRS", "[", 
            RowBox[{"[", "8", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
           RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
           RowBox[{"ra", "\[Rule]", "rt"}], ",", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"c1", "^", "2"}], "+", 
             RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], 
        "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], "}"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pow(c1,2)\>\"", "\[Rule]", "\"\<c1sqr\>\""}], ",", 
      RowBox[{"\"\<pow(c2,2)\>\"", "\[Rule]", "\"\<c2sqr\>\""}], ",", 
      RowBox[{"\"\<pow(xPl,2)\>\"", "\[Rule]", "\"\<xPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(yPl,2)\>\"", "\[Rule]", "\"\<yPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(zPl,2)\>\"", "\[Rule]", "\"\<zPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(rt,2)\>\"", "\[Rule]", "\"\<rtsqr\>\""}], ",", 
      RowBox[{"\"\<pow(delc,2)\>\"", "\[Rule]", "\"\<delcsqr\>\""}], ",", 
      RowBox[{"\"\<pow(c1,4)\>\"", "\[Rule]", "\"\<c1pow4\>\""}], ",", 
      RowBox[{"\"\<pow(c2,4)\>\"", "\[Rule]", "\"\<c2pow4\>\""}]}], "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.6894788149672203`*^9, {3.6894789190617533`*^9, 3.6894789357084*^9}, 
   3.68947932619062*^9, {3.689496401106255*^9, 3.6894964244173203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"CForm", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Mq3RRS", "[", 
             RowBox[{"[", "9", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
          
          RowBox[{"{", 
           RowBox[{
            RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
            RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
            RowBox[{"ra", "\[Rule]", "rt"}], ",", 
            RowBox[{
             RowBox[{"1", "+", 
              RowBox[{"c1", "^", "2"}], "+", 
              RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<pow(c1,2)\>\"", "\[Rule]", "\"\<c1sqr\>\""}], ",", 
       RowBox[{"\"\<pow(c2,2)\>\"", "\[Rule]", "\"\<c2sqr\>\""}], ",", 
       RowBox[{"\"\<pow(xPl,2)\>\"", "\[Rule]", "\"\<xPlsqr\>\""}], ",", 
       RowBox[{"\"\<pow(yPl,2)\>\"", "\[Rule]", "\"\<yPlsqr\>\""}], ",", 
       RowBox[{"\"\<pow(zPl,2)\>\"", "\[Rule]", "\"\<zPlsqr\>\""}], ",", 
       RowBox[{"\"\<pow(rt,2)\>\"", "\[Rule]", "\"\<rtsqr\>\""}], ",", 
       RowBox[{"\"\<pow(delc,2)\>\"", "\[Rule]", "\"\<delcsqr\>\""}], ",", 
       RowBox[{"\"\<pow(c1,4)\>\"", "\[Rule]", "\"\<c1pow4\>\""}], ",", 
       RowBox[{"\"\<pow(c2,4)\>\"", "\[Rule]", "\"\<c2pow4\>\""}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.689479338367391*^9, 3.689479340609579*^9}, {
   3.689496437251392*^9, 3.6894964566006317`*^9}, 3.689497699185054*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cq3RRS", "=", 
   RowBox[{"Cq3RRSt", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", "\[Theta]1"}], ",", 
      RowBox[{
       RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", "\[Phi]1"}], ",", 
      RowBox[{
       RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", "\[Theta]2"}], ",", 
      RowBox[{
       RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", "\[Phi]2"}], ",", 
      RowBox[{
       RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", "\[Theta]3"}], ",", 
      RowBox[{
       RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", "\[Phi]3"}], ",", 
      RowBox[{
       RowBox[{"c1", "[", "t", "]"}], "\[Rule]", "c1"}], ",", 
      RowBox[{
       RowBox[{"c2", "[", "t", "]"}], "\[Rule]", "c2"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", 
       "d\[Theta]1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]1", "'"}], "[", "t", "]"}], "\[Rule]", "d\[Phi]1"}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}], "\[Rule]", 
       "d\[Theta]2"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]2", "'"}], "[", "t", "]"}], "\[Rule]", "d\[Phi]2"}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]3", "'"}], "[", "t", "]"}], "\[Rule]", 
       "d\[Theta]3"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]3", "'"}], "[", "t", "]"}], "\[Rule]", "d\[Phi]3"}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"c1", "'"}], "[", "t", "]"}], "\[Rule]", "dc1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"c2", "'"}], "[", "t", "]"}], "\[Rule]", "dc2"}]}], "}"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.68949771129506*^9, 3.689497762581954*^9}, 
   3.689497852891*^9, {3.689497883993917*^9, 3.6894980806874523`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", 
     RowBox[{
      RowBox[{"Cq3RRS", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
        RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
        RowBox[{"ra", "\[Rule]", "rt"}], ",", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"c1", "^", "2"}], "+", 
          RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Sin(\[Theta]1 - \[Phi]1)\>\"", "\[Rule]", "\"\<sthphi1\>\""}], ",", 
     
     RowBox[{"\"\<d\[Phi]1\>\"", "\[Rule]", "\"\<dphi1\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689498105628137*^9, 3.689498201253035*^9}, {
   3.689498244204691*^9, 3.689498255515785*^9}, 3.689498636282069*^9}],

Cell[BoxData["\<\"List(0,0,0,(dphi1*lCr*lSt*mSt*sthphi1)/2.,0,0,0,0,0)\"\>"], \
"Output",
 CellChangeTimes->{3.689498270810487*^9, 3.689498726410967*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", 
     RowBox[{
      RowBox[{"Cq3RRS", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
        RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
        RowBox[{"ra", "\[Rule]", "rt"}], ",", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"c1", "^", "2"}], "+", 
          RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Sin(\[Theta]2 - \[Phi]2)\>\"", "\[Rule]", "\"\<sthphi2\>\""}], ",", 
     
     RowBox[{"\"\<d\[Phi]2\>\"", "\[Rule]", "\"\<dphi2\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689498226742134*^9, 3.689498288564681*^9}, {
  3.689498657096216*^9, 3.689498688054685*^9}}],

Cell[BoxData["\<\"List(0,0,0,0,(dphi2*lCr*lSt*mSt*sthphi2)/2.,0,0,0,0)\"\>"], \
"Output",
 CellChangeTimes->{{3.689498280584168*^9, 3.689498291587126*^9}, 
   3.689498689364921*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", 
     RowBox[{
      RowBox[{"Cq3RRS", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
        RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
        RowBox[{"ra", "\[Rule]", "rt"}], ",", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"c1", "^", "2"}], "+", 
          RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Sin(\[Theta]3 - \[Phi]3)\>\"", "\[Rule]", "\"\<sthphi3\>\""}], ",", 
     
     RowBox[{"\"\<d\[Phi]3\>\"", "\[Rule]", "\"\<dphi3\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689498307374323*^9, 3.689498329248921*^9}, 
   3.6894986914945507`*^9}],

Cell[BoxData["\<\"List(0,0,0,0,0,(dphi3*lCr*lSt*mSt*sthphi3)/2.,0,0,0)\"\>"], \
"Output",
 CellChangeTimes->{{3.6894983163497133`*^9, 3.689498329648438*^9}, 
   3.6894986919703217`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", 
     RowBox[{
      RowBox[{"Cq3RRS", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
        RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
        RowBox[{"ra", "\[Rule]", "rt"}], ",", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"c1", "^", "2"}], "+", 
          RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Sin(\[Theta]1 - \[Phi]1)\>\"", "\[Rule]", "\"\<sthphi1\>\""}], ",", 
     
     RowBox[{"\"\<d\[Theta]1\>\"", "\[Rule]", "\"\<dtht1\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689498350012547*^9, 3.689498381348577*^9}, 
   3.689498411619637*^9, 3.68949869553659*^9}],

Cell[BoxData["\<\"List(-(dtht1*lCr*lSt*mSt*sthphi1)/2.,0,0,0,0,0,0,0,0)\"\>"],\
 "Output",
 CellChangeTimes->{{3.689498345440278*^9, 3.689498350298781*^9}, {
   3.689498382641391*^9, 3.6894984126323023`*^9}, 3.689498696167204*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", 
     RowBox[{
      RowBox[{"Cq3RRS", "[", 
       RowBox[{"[", "5", "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
        RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
        RowBox[{"ra", "\[Rule]", "rt"}], ",", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"c1", "^", "2"}], "+", 
          RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Sin(\[Theta]2 - \[Phi]2)\>\"", "\[Rule]", "\"\<sthphi2\>\""}], ",", 
     
     RowBox[{"\"\<d\[Theta]2\>\"", "\[Rule]", "\"\<dtht2\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689498402556788*^9, 3.689498440636945*^9}, 
   3.689498701654158*^9}],

Cell[BoxData["\<\"List(0,-(dtht2*lCr*lSt*mSt*sthphi2)/2.,0,0,0,0,0,0,0)\"\>"],\
 "Output",
 CellChangeTimes->{
  3.6894984443918962`*^9, {3.689498700364197*^9, 3.689498702163404*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", 
     RowBox[{
      RowBox[{"Cq3RRS", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
        RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
        RowBox[{"ra", "\[Rule]", "rt"}], ",", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"c1", "^", "2"}], "+", 
          RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "\"\<Sin(\[Theta]3 - \[Phi]3)\>\"", "\[Rule]", "\"\<sthphi3\>\""}], ",", 
     
     RowBox[{"\"\<d\[Theta]3\>\"", "\[Rule]", "\"\<dtht3\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689498464349028*^9, 3.689498477325686*^9}, 
   3.689498705964774*^9}],

Cell[BoxData["\<\"List(0,0,-(dtht3*lCr*lSt*mSt*sthphi3)/2.,0,0,0,0,0,0)\"\>"],\
 "Output",
 CellChangeTimes->{{3.689498474370405*^9, 3.689498477589328*^9}, 
   3.689498706452044*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"CForm", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cq3RRS", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
           RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
           RowBox[{"ra", "\[Rule]", "rt"}], ",", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"c1", "^", "2"}], "+", 
             RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], 
        "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<Sin(\[Theta]3 - \[Phi]3)\>\"", "\[Rule]", "\"\<sthphi3\>\""}], 
        ",", 
        RowBox[{"\"\<d\[Theta]3\>\"", "\[Rule]", "\"\<dtht3\>\""}], ",", 
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}]}], "}"}]}], "]"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pow(c1,2)\>\"", "\[Rule]", "\"\<c1sqr\>\""}], ",", 
      RowBox[{"\"\<pow(c2,2)\>\"", "\[Rule]", "\"\<c2sqr\>\""}], ",", 
      RowBox[{"\"\<pow(xPl,2)\>\"", "\[Rule]", "\"\<xPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(yPl,2)\>\"", "\[Rule]", "\"\<yPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(zPl,2)\>\"", "\[Rule]", "\"\<zPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(rt,2)\>\"", "\[Rule]", "\"\<rtsqr\>\""}], ",", 
      RowBox[{"\"\<pow(delc,2)\>\"", "\[Rule]", "\"\<delcsqr\>\""}], ",", 
      RowBox[{"\"\<pow(c1,4)\>\"", "\[Rule]", "\"\<c1pow4\>\""}], ",", 
      RowBox[{"\"\<pow(c2,4)\>\"", "\[Rule]", "\"\<c2pow4\>\""}]}], "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.689498494848195*^9, {3.6894985258401747`*^9, 3.689498550486389*^9}, 
   3.6894987117003193`*^9, {3.6894988243676567`*^9, 3.689498829706003*^9}, {
   3.689498864106214*^9, 3.68949886516136*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"CForm", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cq3RRS", "[", 
            RowBox[{"[", "8", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
           RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
           RowBox[{"ra", "\[Rule]", "rt"}], ",", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"c1", "^", "2"}], "+", 
             RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], 
        "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<Sin(\[Theta]3 - \[Phi]3)\>\"", "\[Rule]", "\"\<sthphi3\>\""}], 
        ",", 
        RowBox[{"\"\<d\[Theta]3\>\"", "\[Rule]", "\"\<dtht3\>\""}], ",", 
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}]}], "}"}]}], "]"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pow(c1,2)\>\"", "\[Rule]", "\"\<c1sqr\>\""}], ",", 
      RowBox[{"\"\<pow(c2,2)\>\"", "\[Rule]", "\"\<c2sqr\>\""}], ",", 
      RowBox[{"\"\<pow(xPl,2)\>\"", "\[Rule]", "\"\<xPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(yPl,2)\>\"", "\[Rule]", "\"\<yPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(zPl,2)\>\"", "\[Rule]", "\"\<zPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(rt,2)\>\"", "\[Rule]", "\"\<rtsqr\>\""}], ",", 
      RowBox[{"\"\<pow(delc,2)\>\"", "\[Rule]", "\"\<delcsqr\>\""}], ",", 
      RowBox[{"\"\<pow(c1,4)\>\"", "\[Rule]", "\"\<c1pow4\>\""}], ",", 
      RowBox[{"\"\<pow(c2,4)\>\"", "\[Rule]", "\"\<c2pow4\>\""}]}], "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.689498875550398*^9, 3.68949887851302*^9}, 
   3.6894990162421227`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"CForm", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cq3RRS", "[", 
            RowBox[{"[", "9", "]"}], "]"}], "//", "Simplify"}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
           RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
           RowBox[{"ra", "\[Rule]", "rt"}], ",", 
           RowBox[{
            RowBox[{"1", "+", 
             RowBox[{"c1", "^", "2"}], "+", 
             RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], 
        "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<Sin(\[Theta]3 - \[Phi]3)\>\"", "\[Rule]", "\"\<sthphi3\>\""}], 
        ",", 
        RowBox[{"\"\<d\[Theta]3\>\"", "\[Rule]", "\"\<dtht3\>\""}], ",", 
        RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}]}], "}"}]}], "]"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<pow(c1,2)\>\"", "\[Rule]", "\"\<c1sqr\>\""}], ",", 
      RowBox[{"\"\<pow(c2,2)\>\"", "\[Rule]", "\"\<c2sqr\>\""}], ",", 
      RowBox[{"\"\<pow(xPl,2)\>\"", "\[Rule]", "\"\<xPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(yPl,2)\>\"", "\[Rule]", "\"\<yPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(zPl,2)\>\"", "\[Rule]", "\"\<zPlsqr\>\""}], ",", 
      RowBox[{"\"\<pow(rt,2)\>\"", "\[Rule]", "\"\<rtsqr\>\""}], ",", 
      RowBox[{"\"\<pow(delc,2)\>\"", "\[Rule]", "\"\<delcsqr\>\""}], ",", 
      RowBox[{"\"\<pow(c1,4)\>\"", "\[Rule]", "\"\<c1pow4\>\""}], ",", 
      RowBox[{"\"\<pow(c2,4)\>\"", "\[Rule]", "\"\<c2pow4\>\""}]}], "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.689499029941226*^9, 3.689499034962736*^9}, 
   3.6895573166840467`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CForm", "[", 
       RowBox[{"Gq3RRS", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
          RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
          RowBox[{"ra", "\[Rule]", "rt"}], ",", 
          RowBox[{
           RowBox[{"1", "+", 
            RowBox[{"c1", "^", "2"}], "+", 
            RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], "}"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<pow(delc,2)\>\"", "\[Rule]", "\"\<delcsqr\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]1)\>\"", "\[Rule]", "\"\<cth1\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]2)\>\"", "\[Rule]", "\"\<cth2\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]3)\>\"", "\[Rule]", "\"\<cth3\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Phi]1)\>\"", "\[Rule]", "\"\<cphi1\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Phi]2)\>\"", "\[Rule]", "\"\<cphi2\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Phi]3)\>\"", "\[Rule]", "\"\<cphi3\>\""}], ",", 
     RowBox[{"\"\<pow(c1,2)\>\"", "\[Rule]", "\"\<c1sqr\>\""}], ",", 
     RowBox[{"\"\<pow(c2,2)\>\"", "\[Rule]", "\"\<c2sqr\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6895573535525618`*^9, 3.689557661800578*^9}}],

Cell[BoxData["\<\"List(g*((lCr*mCr*cth1)/2. + \
lCr*mSt*cth1),g*((lCr*mCr*cth2)/2. + lCr*mSt*cth2),g*((lCr*mCr*cth3)/2. + \
lCr*mSt*cth3),(g*lSt*mSt*cphi1)/2.,(g*lSt*mSt*cphi2)/2.,(g*lSt*mSt*cphi3)/2.,\
g*mPl*((4*c1*c2*xPl)/delcsqr - (4*c1sqr*yPl)/delcsqr + (2*yPl)/delc + \
(2*c1*(-1 + c1sqr + c2sqr)*zPl)/delcsqr - \
(2*c1*zPl)/delc),g*mPl*((4*c2sqr*xPl)/delcsqr - (2*xPl)/delc - \
(4*c1*c2*yPl)/delcsqr + (2*c2*(-1 + c1sqr + c2sqr)*zPl)/delcsqr - \
(2*c2*zPl)/delc),g*(mPl + mTp))\"\>"], "Output",
 CellChangeTimes->{{3.6895575221424417`*^9, 3.689557575041257*^9}, {
  3.689557618093298*^9, 3.689557662600627*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", 
     RowBox[{"J\[Eta]\[Theta]", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
        RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
        RowBox[{"ra", "\[Rule]", "rt"}], ",", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"c1", "^", "2"}], "+", 
          RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Sin(\[Theta]1)\>\"", "\[Rule]", "\"\<sth1\>\""}], ",", 
     RowBox[{"\"\<Sin(\[Theta]2)\>\"", "\[Rule]", "\"\<sth2\>\""}], ",", 
     RowBox[{"\"\<Sin(\[Theta]3)\>\"", "\[Rule]", "\"\<sth3\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]1)\>\"", "\[Rule]", "\"\<cth1\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]2)\>\"", "\[Rule]", "\"\<cth2\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]3)\>\"", "\[Rule]", "\"\<cth3\>\""}]}], "}"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.689558332326827*^9, 3.6895584129045753`*^9}, {
  3.689558496820464*^9, 3.689558690936061*^9}}],

Cell[BoxData["\<\"List(List(delc*lCr*sth1,0,0),List(-(delc*lCr*cth1),0,0),\
List(0,delc*lCr*sth2,0),List(0,-(delc*lCr*cth2),0),List(0,0,delc*lCr*sth3),\
List(0,0,-(delc*lCr*cth3)))\"\>"], "Output",
 CellChangeTimes->{{3.6895583376663723`*^9, 3.689558360172089*^9}, 
   3.6895585520865297`*^9, {3.6895585881979923`*^9, 3.689558657295494*^9}, 
   3.6895586914014874`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"CForm", "[", 
     RowBox[{"J\[Eta]\[Phi]", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lcr", "\[Rule]", "lCr"}], ",", 
        RowBox[{"lst", "\[Rule]", "lSt"}], ",", 
        RowBox[{"ra", "\[Rule]", "rt"}], ",", 
        RowBox[{
         RowBox[{"1", "+", 
          RowBox[{"c1", "^", "2"}], "+", 
          RowBox[{"c2", "^", "2"}]}], "\[Rule]", "delc"}]}], "}"}]}], "]"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Sin(\[Theta]1)\>\"", "\[Rule]", "\"\<sth1\>\""}], ",", 
     RowBox[{"\"\<Sin(\[Theta]2)\>\"", "\[Rule]", "\"\<sth2\>\""}], ",", 
     RowBox[{"\"\<Sin(\[Theta]3)\>\"", "\[Rule]", "\"\<sth3\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]1)\>\"", "\[Rule]", "\"\<cth1\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]2)\>\"", "\[Rule]", "\"\<cth2\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Theta]3)\>\"", "\[Rule]", "\"\<cth3\>\""}], ",", 
     RowBox[{"\"\<Sin(\[Phi]1)\>\"", "\[Rule]", "\"\<sphi1\>\""}], ",", 
     RowBox[{"\"\<Sin(\[Phi]2)\>\"", "\[Rule]", "\"\<sphi2\>\""}], ",", 
     RowBox[{"\"\<Sin(\[Phi]3)\>\"", "\[Rule]", "\"\<sphi3\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Phi]1)\>\"", "\[Rule]", "\"\<cphi1\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Phi]2)\>\"", "\[Rule]", "\"\<cphi2\>\""}], ",", 
     RowBox[{"\"\<Cos(\[Phi]3)\>\"", "\[Rule]", "\"\<cphi3\>\""}], ",", 
     RowBox[{"\"\<rb\>\"", "\[Rule]", "\"\<b\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.689558819750692*^9, 3.68955897080343*^9}, {
  3.689559023011059*^9, 3.689559031180067*^9}, {3.689559083988974*^9, 
  3.6895590980689917`*^9}}],

Cell[BoxData["\<\"List(List(delc*lSt*sphi1,0,0,-2*c1*b + 4*c1*rt - \
2*c1*lCr*cth1 - 2*c1*lSt*cphi1,-2*c2*b - 4*c2*rt - 2*c2*lCr*cth1 - \
2*c2*lSt*cphi1,0),List(-(delc*lSt*cphi1),0,0,2*c1*z - 2*c1*lCr*sth1 - \
2*c1*lSt*sphi1,-2*rt + 2*c2*z - 2*c2*lCr*sth1 - \
2*c2*lSt*sphi1,delc),List(0,delc*lSt*sphi2,0,-2*c1*b - 2*c1*rt - \
2*Sqrt(3)*c2*rt - 2*c1*lCr*cth2 - 2*c1*lSt*cphi2,-2*c2*b - 2*Sqrt(3)*c1*rt + \
2*c2*rt - 2*c2*lCr*cth2 - \
2*c2*lSt*cphi2,0),List(0,-(delc*lSt*cphi2),0,Sqrt(3)*rt + 2*c1*z - \
2*c1*lCr*sth2 - 2*c1*lSt*sphi2,rt + 2*c2*z - 2*c2*lCr*sth2 - \
2*c2*lSt*sphi2,delc),List(0,0,delc*lSt*sphi3,-2*c1*b - 2*c1*rt + \
2*Sqrt(3)*c2*rt - 2*c1*lCr*cth3 - 2*c1*lSt*cphi3,-2*c2*b + 2*Sqrt(3)*c1*rt + \
2*c2*rt - 2*c2*lCr*cth3 - \
2*c2*lSt*cphi3,0),List(0,0,-(delc*lSt*cphi3),-(Sqrt(3)*rt) + 2*c1*z - \
2*c1*lCr*sth3 - 2*c1*lSt*sphi3,rt + 2*c2*z - 2*c2*lCr*sth3 - \
2*c2*lSt*sphi3,delc))\"\>"], "Output",
 CellChangeTimes->{{3.689558825611508*^9, 3.689558863193543*^9}, 
   3.689558914049258*^9, {3.6895589526446533`*^9, 3.6895589714421663`*^9}, 
   3.689559031553753*^9, {3.689559084313066*^9, 3.689559098521525*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.689476446655645*^9, 3.68947644900393*^9}}],

Cell[BoxData["Mq"], "Input",
 CellChangeTimes->{{3.689476415333116*^9, 3.689476416133997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Gq", " ", "=", " ", 
   RowBox[{"CForm", "[", "gg", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.679045924154044*^9, 3.679045935699279*^9}, {
   3.679046259589616*^9, 3.679046259744379*^9}, 3.679197504857692*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"J\[Eta]\[Theta]", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[Eta]", ",", 
     RowBox[{"{", "\[Theta]", "}"}]}], "]"}], "/.", "subt"}]}]], "Input",
 CellChangeTimes->{{3.67904676259135*^9, 3.679046774981893*^9}, {
  3.679046842538756*^9, 3.6790469675858517`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"delc", " ", "lCr", " ", "stht1"}], ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "ctht1"}], " ", "delc", " ", "lCr"}], ",", "0", ",", "0"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"delc", " ", "lCr", " ", "stht2"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "ctht2"}], " ", "delc", " ", "lCr"}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"delc", " ", "lCr", " ", "stht3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "ctht3"}], " ", "delc", " ", "lCr"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.679046861024198*^9, {3.679046897474483*^9, 3.6790469229277153`*^9}, {
   3.679046955420279*^9, 3.67904697333419*^9}, 3.679195519621461*^9, {
   3.6791975212166*^9, 3.679197537845031*^9}, 3.679462337648787*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"J\[Eta]\[Phi]", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[Eta]", ",", 
     RowBox[{"{", "\[Phi]", "}"}]}], "]"}], "/.", "subt"}]}]], "Input",
 CellChangeTimes->{{3.6790470923072987`*^9, 3.6790471402613163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"delc", " ", "lSt", " ", "sgam1"}], ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c1", " ", "ctht1", " ", "lCr"}], "-", 
      RowBox[{"2", " ", "c1", " ", "cgam1", " ", "lSt"}], "-", 
      RowBox[{"2", " ", "c1", " ", "rb"}], "+", 
      RowBox[{"4", " ", "c1", " ", "rt"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c2", " ", "ctht1", " ", "lCr"}], "-", 
      RowBox[{"2", " ", "c2", " ", "cgam1", " ", "lSt"}], "-", 
      RowBox[{"2", " ", "c2", " ", "rb"}], "-", 
      RowBox[{"4", " ", "c2", " ", "rt"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "cgam1"}], " ", "delc", " ", "lSt"}], ",", "0", ",", "0", 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c1", " ", "lSt", " ", "sgam1"}], "-", 
      RowBox[{"2", " ", "c1", " ", "lCr", " ", "stht1"}], "+", 
      RowBox[{"2", " ", "c1", " ", "z"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "rt"}], "-", 
      RowBox[{"2", " ", "c2", " ", "lSt", " ", "sgam1"}], "-", 
      RowBox[{"2", " ", "c2", " ", "lCr", " ", "stht1"}], "+", 
      RowBox[{"2", " ", "c2", " ", "z"}]}], ",", "delc"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"delc", " ", "lSt", " ", "sgam2"}], ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c1", " ", "ctht2", " ", "lCr"}], "-", 
      RowBox[{"2", " ", "c1", " ", "cgam2", " ", "lSt"}], "-", 
      RowBox[{"2", " ", "c1", " ", "rb"}], "-", 
      RowBox[{"2", " ", "c1", " ", "rt"}], "-", 
      RowBox[{"2", " ", 
       SqrtBox["3"], " ", "c2", " ", "rt"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c2", " ", "ctht2", " ", "lCr"}], "-", 
      RowBox[{"2", " ", "c2", " ", "cgam2", " ", "lSt"}], "-", 
      RowBox[{"2", " ", "c2", " ", "rb"}], "-", 
      RowBox[{"2", " ", 
       SqrtBox["3"], " ", "c1", " ", "rt"}], "+", 
      RowBox[{"2", " ", "c2", " ", "rt"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "cgam2"}], " ", "delc", " ", "lSt"}], ",", "0", ",", 
     RowBox[{
      RowBox[{
       SqrtBox["3"], " ", "rt"}], "-", 
      RowBox[{"2", " ", "c1", " ", "lSt", " ", "sgam2"}], "-", 
      RowBox[{"2", " ", "c1", " ", "lCr", " ", "stht2"}], "+", 
      RowBox[{"2", " ", "c1", " ", "z"}]}], ",", 
     RowBox[{"rt", "-", 
      RowBox[{"2", " ", "c2", " ", "lSt", " ", "sgam2"}], "-", 
      RowBox[{"2", " ", "c2", " ", "lCr", " ", "stht2"}], "+", 
      RowBox[{"2", " ", "c2", " ", "z"}]}], ",", "delc"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"delc", " ", "lSt", " ", "sgam3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c1", " ", "ctht3", " ", "lCr"}], "-", 
      RowBox[{"2", " ", "c1", " ", "cgam3", " ", "lSt"}], "-", 
      RowBox[{"2", " ", "c1", " ", "rb"}], "-", 
      RowBox[{"2", " ", "c1", " ", "rt"}], "+", 
      RowBox[{"2", " ", 
       SqrtBox["3"], " ", "c2", " ", "rt"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c2", " ", "ctht3", " ", "lCr"}], "-", 
      RowBox[{"2", " ", "c2", " ", "cgam3", " ", "lSt"}], "-", 
      RowBox[{"2", " ", "c2", " ", "rb"}], "+", 
      RowBox[{"2", " ", 
       SqrtBox["3"], " ", "c1", " ", "rt"}], "+", 
      RowBox[{"2", " ", "c2", " ", "rt"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "cgam3"}], " ", "delc", " ", "lSt"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["3"]}], " ", "rt"}], "-", 
      RowBox[{"2", " ", "c1", " ", "lSt", " ", "sgam3"}], "-", 
      RowBox[{"2", " ", "c1", " ", "lCr", " ", "stht3"}], "+", 
      RowBox[{"2", " ", "c1", " ", "z"}]}], ",", 
     RowBox[{"rt", "-", 
      RowBox[{"2", " ", "c2", " ", "lSt", " ", "sgam3"}], "-", 
      RowBox[{"2", " ", "c2", " ", "lCr", " ", "stht3"}], "+", 
      RowBox[{"2", " ", "c2", " ", "z"}]}], ",", "delc"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6790471137554092`*^9, 3.679047118625104*^9}, 
   3.6790471567668877`*^9, 3.679195519841488*^9, 3.679197604546327*^9, 
   3.67946233779525*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Data", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"linklength", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rb", "\[Rule]", " ", ".3"}], ",", 
       RowBox[{"lcr", "\[Rule]", "  ", ".4"}], ",", " ", 
       RowBox[{"lst", "\[Rule]", ".3533"}], ",", " ", 
       RowBox[{"ra", "\[Rule]", ".599"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pldata", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xPl", "\[Rule]", "0.10"}], ",", 
       RowBox[{"yPl", "\[Rule]", "0.10"}], ",", 
       RowBox[{"zPl", "\[Rule]", " ", "0.625"}], ",", 
       RowBox[{"dt", "\[Rule]", " ", 
        RowBox[{".272", "*", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mass", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mCr", "\[Rule]", "4.156"}], ",", 
       RowBox[{"mSt", "\[Rule]", "12.241"}], ",", 
       RowBox[{"mTp", "\[Rule]", "10.274"}], ",", 
       RowBox[{"mPl1", "\[Rule]", "60"}], ",", 
       RowBox[{"mPl2", "\[Rule]", "120"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inertia", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ICrx", "\[Rule]", 
        RowBox[{"3456", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}]}]}], ",", 
       RowBox[{"ICry", "\[Rule]", 
        RowBox[{"40361", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}]}]}], ",", 
       RowBox[{"ICrz", "\[Rule]", 
        RowBox[{"37181", "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "6"}]}]}]}], ",", 
       RowBox[{"IStx", "\[Rule]", "0.000123177"}], ",", 
       RowBox[{"ISty", "\[Rule]", "0.645853"}], ",", 
       RowBox[{"IStz", "\[Rule]", "0.0209788"}], ",", 
       RowBox[{"ITpx", "\[Rule]", "0.300670"}], ",", 
       RowBox[{"ITpy", "\[Rule]", "0.300670"}], ",", 
       RowBox[{"ITpz", "\[Rule]", "0.542725"}], ",", 
       RowBox[{"IPlx", "\[Rule]", "16.825"}], ",", 
       RowBox[{"IPly", "\[Rule]", "16.825"}], ",", 
       RowBox[{"IPlz", "\[Rule]", "2.4"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"linklength", ",", "mass", ",", "inertia", ",", "pldata"}], 
      "]"}]}], " ", ";"}]}]}]], "Input",
 CellChangeTimes->{{3.623518653973322*^9, 3.6235187050232077`*^9}, 
   3.623519585293497*^9, {3.623519656658828*^9, 3.623519718038783*^9}, {
   3.623519780982037*^9, 3.623519814580415*^9}, {3.6235198508143463`*^9, 
   3.623519954011952*^9}, {3.623520449801076*^9, 3.62352045701991*^9}, 
   3.623520491682559*^9, {3.623520708269524*^9, 3.62352078308237*^9}, {
   3.623520827558322*^9, 3.623520830736136*^9}, {3.623520861798398*^9, 
   3.623520868100544*^9}, {3.623520924859275*^9, 3.623520933218816*^9}, {
   3.623520975409396*^9, 3.6235210388771477`*^9}, {3.6238563206893682`*^9, 
   3.62385633026622*^9}, {3.623929610514267*^9, 3.623929691610214*^9}, {
   3.623931666709457*^9, 3.6239317157709417`*^9}, {3.623931839212195*^9, 
   3.6239318482917433`*^9}, {3.623932370782572*^9, 3.6239324000715714`*^9}, {
   3.623948113845683*^9, 3.6239481196572313`*^9}, {3.6239804820421057`*^9, 
   3.6239804941215677`*^9}, {3.623993601200767*^9, 3.623993603124166*^9}, {
   3.623993650647637*^9, 3.6239936608920794`*^9}, {3.6240680738477*^9, 
   3.624068077701241*^9}, {3.6240682509730263`*^9, 3.624068264901951*^9}, {
   3.62407113381081*^9, 3.6240711355565157`*^9}, {3.624074059414238*^9, 
   3.624074065269226*^9}, 3.6240741136239033`*^9, {3.624074308229651*^9, 
   3.6240743188398523`*^9}, {3.624074419832713*^9, 3.62407442478371*^9}, {
   3.624081565497316*^9, 3.624081577509005*^9}, {3.6242500844761047`*^9, 
   3.624250107521446*^9}, {3.624250160601974*^9, 3.624250161022807*^9}, {
   3.624332457692442*^9, 3.624332461387392*^9}, {3.624440305603463*^9, 
   3.6244403112791147`*^9}, {3.6244544109570103`*^9, 3.62445441603918*^9}, {
   3.627631050187108*^9, 3.627631056695978*^9}, {3.627631690960997*^9, 
   3.6276317461234293`*^9}, {3.6278522625285378`*^9, 
   3.6278523062249107`*^9}, {3.6278524614917707`*^9, 3.627852511645529*^9}, 
   3.632752719755013*^9, {3.6344676639093723`*^9, 3.634467667163472*^9}, 
   3.634467699250729*^9, {3.639511102873595*^9, 3.6395111616970873`*^9}, {
   3.639512040220924*^9, 3.639512041066347*^9}, {3.675761648965023*^9, 
   3.675761667134383*^9}, {3.6757620674954433`*^9, 3.675762071703156*^9}, {
   3.675762230680402*^9, 3.675762230848716*^9}, {3.675998353345512*^9, 
   3.67599838080208*^9}, {3.6790127620423193`*^9, 3.67901279369249*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"trJ\[Eta]q", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"J\[Eta]q", "/.", "subsqt"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dJ\[Eta]q", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"J\[Eta]q", "/.", "subsqt"}], ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dq", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"q", "/.", "subsqt"}], ",", "t"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.623516738432993*^9, 3.623516746773679*^9}, {
   3.623517840863455*^9, 3.623517917010502*^9}, 3.62351796714688*^9, {
   3.623991622519483*^9, 3.623991632730831*^9}, 3.623992766108807*^9, 
   3.623993252615613*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ddq", "=", 
   RowBox[{"D", "[", 
    RowBox[{"dq", ",", "t"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.623855920136907*^9, 3.623855935409758*^9}, {
  3.675763125200471*^9, 3.675763129897325*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subMq", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"N", "[", 
     RowBox[{"Mq3RRSt", "/.", "data"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6238561854513187`*^9, 3.623856217556958*^9}, {
   3.6238562921435003`*^9, 3.623856293730105*^9}, 3.6238584590931063`*^9, {
   3.623858733821748*^9, 3.623858734165134*^9}, 3.623858847598576*^9, {
   3.623931754541526*^9, 3.623931756401525*^9}, {3.6243038102829523`*^9, 
   3.624303820862853*^9}, {3.625153663093445*^9, 3.6251536638989983`*^9}, {
   3.632752769447434*^9, 3.632752780808086*^9}, {3.632752830125382*^9, 
   3.632752841333744*^9}, {3.634467958097283*^9, 3.63446796627619*^9}, {
   3.634468598345891*^9, 3.634468622561571*^9}, {3.675763169179163*^9, 
   3.675763176491014*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"subCq", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"N", "[", 
     RowBox[{"CmfromM", "[", 
      RowBox[{"subMq", ",", 
       RowBox[{"q", "/.", "subsqt"}]}], "]"}], "]"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.623863757549156*^9, 3.623863781763136*^9}, 
   3.623925310466784*^9, 3.623925931106914*^9, 3.6240271884927177`*^9, 
   3.624029985666563*^9, {3.62430382629141*^9, 3.624303832708387*^9}, {
   3.676053424711973*^9, 3.676053430822229*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"yes\"\>"], "Print",
 CellChangeTimes->{
  3.675763141052265*^9, 3.675763182500433*^9, 3.67577342299234*^9, 
   3.6757890185156107`*^9, 3.675954034773988*^9, {3.676053418148809*^9, 
   3.67605343571574*^9}, 3.676058120193206*^9, 3.6760584357703733`*^9, 
   3.676085262002809*^9, 3.676096567205124*^9, 3.67919552096037*^9, 
   3.6794623390028267`*^9}],

Cell[BoxData["\<\"yes\"\>"], "Print",
 CellChangeTimes->{
  3.675763141052265*^9, 3.675763182500433*^9, 3.67577342299234*^9, 
   3.6757890185156107`*^9, 3.675954034773988*^9, {3.676053418148809*^9, 
   3.67605343571574*^9}, 3.676058120193206*^9, 3.6760584357703733`*^9, 
   3.676085262002809*^9, 3.676096567205124*^9, 3.67919552096037*^9, 
   3.679462339029686*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"size", "[", "subCq", "]"}]], "Input",
 CellChangeTimes->{{3.623997737547987*^9, 3.623997742132807*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Size of the expression is:\"\>", "\[InvisibleSpace]", 
   "234.128`", "\[InvisibleSpace]", "\<\" KB.\"\>"}],
  SequenceForm["Size of the expression is:", 234.128, " KB."],
  Editable->False]], "Print",
 CellChangeTimes->{3.6757643233479567`*^9, 3.6757734232452374`*^9, 
  3.6757890188368692`*^9, 3.676058120310546*^9, 3.676058436039488*^9, 
  3.6760852622903557`*^9, 3.676096567467717*^9, 3.67919552634717*^9, 
  3.679462344361122*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"subGq", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"N", "[", 
     RowBox[{"Gq3RRSt", "/.", "data"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6238565550833673`*^9, 3.623856569938424*^9}, 
   3.6238584641751537`*^9, {3.623858719906065*^9, 3.623858729515752*^9}, 
   3.623858842336993*^9, {3.623931762944069*^9, 3.623931764011113*^9}, {
   3.624303839777761*^9, 3.624303845215643*^9}, {3.675764589674951*^9, 
   3.675764590854145*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subJ\[Eta]q", "=", 
   RowBox[{
    RowBox[{"J\[Eta]q", "/.", "subsqt"}], "/.", "data"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.623858221349264*^9, 3.623858280622726*^9}, {
   3.623858740624877*^9, 3.6238587409591417`*^9}, 3.623864296730032*^9, {
   3.623931768162759*^9, 3.623931768552393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subdJ\[Eta]q", "=", 
   RowBox[{"dJ\[Eta]q", "/.", "data"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.623858792501708*^9, 3.623858794526452*^9}, 
   3.623864298420289*^9, {3.623865384322113*^9, 3.623865385990356*^9}, {
   3.623931774199161*^9, 3.6239317747247963`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"massMatrix", "[", 
    RowBox[{
     RowBox[{"q_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", "t1_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Mq", ",", "subsq"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subsq", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"z", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "9", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mq", "=", 
       RowBox[{"subMq", "/.", "subsq"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Mq", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6239224151432467`*^9, 3.6239224345920258`*^9}, {
   3.623922487944067*^9, 3.623922565516626*^9}, {3.6239289306645203`*^9, 
   3.623928932854044*^9}, {3.623997788811665*^9, 3.623997815679443*^9}, 
   3.624013819617037*^9, {3.625125038127597*^9, 3.625125047004533*^9}, 
   3.625126102829109*^9, {3.625127226407693*^9, 3.625127227458572*^9}, {
   3.625127308181686*^9, 3.625127315843135*^9}, {3.625128696241063*^9, 
   3.62512870573624*^9}, {3.6251422525553627`*^9, 3.625142275582893*^9}, {
   3.6251423228961287`*^9, 3.625142344947384*^9}, {3.6251423847872066`*^9, 
   3.625142410730014*^9}, {3.625142486376288*^9, 3.6251425055258837`*^9}, {
   3.6251425789662523`*^9, 3.62514258135511*^9}, 3.625142619918578*^9, {
   3.62514270083633*^9, 3.625142710893361*^9}, {3.625142820692191*^9, 
   3.6251428762288637`*^9}, {3.625143522046907*^9, 3.625143527207734*^9}, {
   3.6251436836761303`*^9, 3.6251436839708242`*^9}, {3.6251438586373377`*^9, 
   3.625143864798339*^9}, {3.625145827375925*^9, 3.625145827630168*^9}, {
   3.6251474454635553`*^9, 3.625147446291273*^9}, 3.6251499185974293`*^9, {
   3.625150549123341*^9, 3.625150555033777*^9}, {3.625150650336339*^9, 
   3.62515068466883*^9}, {3.625150899783998*^9, 3.6251509018323507`*^9}, {
   3.6757652765749187`*^9, 3.675765288431653*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cMatrix", "[", 
    RowBox[{
     RowBox[{"q_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", 
     RowBox[{"dq_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", "t1_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"subsq", ",", "subsdq", ",", "ii", ",", "jj", ",", "Cq"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Start Cq\>\"", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cq", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "9"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"subsq", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"z", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "9", "]"}], "]"}]}]}], "}"}]}], ";", 
      RowBox[{"subsdq", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]3", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]3", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"c1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"c2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "9", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "\[LessEqual]", "9"}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"jj", "=", "1"}], ",", 
           RowBox[{"jj", "\[LessEqual]", "9"}], ",", 
           RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Cq", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{"subCq", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "jj"}], "]"}], "]"}], "/.", "subsq"}], "/.",
               "subsdq"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<End Cq\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Cq", "]"}], ";"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675772883158061*^9, 3.675772898328025*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gMatrix", "[", 
    RowBox[{
     RowBox[{"q_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", "t1_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Gq", ",", "subsq", ",", "g"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subsq", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"z", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "9", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", "9.812"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Gq", "=", 
       RowBox[{"(", 
        RowBox[{"subGq", "/.", "subsq"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Gq", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675772957224016*^9, 3.675772958671647*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"calcQc", "[", 
    RowBox[{
     RowBox[{"q_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", 
     RowBox[{"dq_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", "t1_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "subsq", ",", "subsdq", ",", "valJ\[Eta]q", ",", "valMinv", ",", 
       "valdJ\[Eta]q", ",", "\[Lambda]", ",", "Qc", ",", "Mq", ",", "valCq", 
       ",", "valGq"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<Start Qc\>\"", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subsq", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"z", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"q", "[", 
           RowBox[{"[", "9", "]"}], "]"}]}]}], "}"}]}], ";", 
      RowBox[{"subsdq", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]3", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]3", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"c1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"c2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "8", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"dq", "[", 
           RowBox[{"[", "9", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mq", "=", 
       RowBox[{"massMatrix", "[", 
        RowBox[{"q", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"valCq", "=", 
       RowBox[{"cMatrix", "[", 
        RowBox[{"q", ",", "dq", ",", "t"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"valGq", "=", 
       RowBox[{"gMatrix", "[", 
        RowBox[{"q", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"valJ\[Eta]q", "=", 
       RowBox[{"subJ\[Eta]q", "/.", "subsq"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"valMinv", "=", 
       RowBox[{"Inverse", "[", "Mq", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"valdJ\[Eta]q", "=", 
       RowBox[{
        RowBox[{"subdJ\[Eta]q", "/.", "subsq"}], "/.", "subsdq"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "valJ\[Eta]q", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"-", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{"(", 
            RowBox[{"valJ\[Eta]q", ".", "valMinv", ".", 
             RowBox[{"Transpose", "[", "valJ\[Eta]q", "]"}]}], ")"}], "]"}], 
          ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"valdJ\[Eta]q", ".", "dq"}], "+", 
            RowBox[{"valJ\[Eta]q", ".", "valMinv", ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"valCq", ".", "dq"}]}], "-", "valGq"}], ")"}]}]}], 
           ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Qc", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "valJ\[Eta]q", "]"}], ".", "\[Lambda]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<End Qc\>\"", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"N", "[", "Qc", "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675773042662497*^9, 3.675773046462096*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"subsqt", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "\[Rule]", 
      RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
     RowBox[{"\[Theta]2", "\[Rule]", 
      RowBox[{"\[Theta]2", "[", "t", "]"}]}], ",", 
     RowBox[{"\[Theta]3", "\[Rule]", 
      RowBox[{"\[Theta]3", "[", "t", "]"}]}], ",", 
     RowBox[{"\[Phi]1", "\[Rule]", 
      RowBox[{"\[Phi]1", "[", "t", "]"}]}], ",", 
     RowBox[{"\[Phi]2", "\[Rule]", 
      RowBox[{"\[Phi]2", "[", "t", "]"}]}], ",", 
     RowBox[{"\[Phi]3", "\[Rule]", 
      RowBox[{"\[Phi]3", "[", "t", "]"}]}], ",", 
     RowBox[{"c1", "\[Rule]", 
      RowBox[{"c1", "[", "t", "]"}]}], ",", 
     RowBox[{"c2", "\[Rule]", 
      RowBox[{"c2", "[", "t", "]"}]}], ",", 
     RowBox[{"z", "\[Rule]", 
      RowBox[{"z", "[", "t", "]"}]}]}], "}"}]}], ";", 
  RowBox[{"subsqtre", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", "tht1"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", "tht2"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", "tht3"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", "phi1"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", "phi2"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", "phi3"}], ",", 
     RowBox[{
      RowBox[{"c1", "[", "t", "]"}], "\[Rule]", "c1"}], ",", 
     RowBox[{
      RowBox[{"c2", "[", "t", "]"}], "\[Rule]", "c2"}], ",", 
     RowBox[{
      RowBox[{"z", "[", "t", "]"}], "\[Rule]", "z"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"subsderv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", "dtht1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}], "\[Rule]", "dtht2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]3", "'"}], "[", "t", "]"}], "\[Rule]", "dtht3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]1", "'"}], "[", "t", "]"}], "\[Rule]", "dphi1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]2", "'"}], "[", "t", "]"}], "\[Rule]", "dphi2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]3", "'"}], "[", "t", "]"}], "\[Rule]", "dphi3"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c1", "'"}], "[", "t", "]"}], "\[Rule]", "dc1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"c2", "'"}], "[", "t", "]"}], "\[Rule]", "dc2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "'"}], "[", "t", "]"}], "\[Rule]", "dz"}]}], "}"}]}], ";", 
  RowBox[{"subsmisc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"c1", "^", "2"}], "+", 
        RowBox[{"c2", "^", "2"}]}], ")"}], "\[Rule]", "delc"}], ",", 
     RowBox[{"Power", "\[Rule]", "pow"}], ",", 
     RowBox[{"Sin", "\[Rule]", "sin"}], ",", 
     RowBox[{"Cos", "\[Rule]", "cos"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675776410586276*^9, 3.675776424049087*^9}, 
   3.675776455566071*^9, 3.675776514300049*^9, {3.675994966151743*^9, 
   3.675994976577035*^9}, {3.675995039895418*^9, 3.67599504942101*^9}, {
   3.675995194495809*^9, 3.67599520035037*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "initial", " ", "conditions", " ", "for", " ", "config", " ", "space", " ",
     "variables"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"qval", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"q", "/.", "subsqt"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"c1", "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
        RowBox[{
         RowBox[{"c2", "[", "t", "]"}], "\[Rule]", "0.13165249758739583`"}], 
        ",", 
        RowBox[{
         RowBox[{"z", "[", "t", "]"}], "\[Rule]", "0.3`"}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", "1.599525280781688`"}],
        ",", 
       RowBox[{
        RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", "1.817781925534272`"}],
        ",", 
       RowBox[{
        RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", "1.817781925534272`"}],
        ",", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", 
        RowBox[{"-", "1.0793166709573745`"}]}], ",", 
       RowBox[{
        RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", 
        "0.2712420549460831"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", 
        "0.2712420549460831`"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"dqval", "=", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0", ",", "0"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.675995636281398*^9, 3.675995686732174*^9}, 
   3.675998103913703*^9, {3.675998475016416*^9, 3.675998496786194*^9}, {
   3.6759986011161337`*^9, 3.675998624282741*^9}, {3.675998663933999*^9, 
   3.6759986931909018`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.0793166709573745`"}], ",", "0.2712420549460831`", ",", 
   "0.2712420549460831`", ",", "1.599525280781688`", ",", 
   "1.817781925534272`", ",", "1.817781925534272`", ",", "0.`", ",", 
   "0.13165249758739583`", ",", "0.3`"}], "}"}]], "Output",
 CellChangeTimes->{3.675998698372663*^9, 3.675998870440631*^9, 
  3.676057671400536*^9, 3.6760581204779654`*^9, 3.6760584362116823`*^9, 
  3.676084232968918*^9, 3.6760852626727657`*^9, 3.676096567593688*^9, 
  3.679195526612694*^9, 3.679462345044958*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.675998698372663*^9, 3.675998870440631*^9, 
  3.676057671400536*^9, 3.6760581204779654`*^9, 3.6760584362116823`*^9, 
  3.676084232968918*^9, 3.6760852626727657`*^9, 3.676096567593688*^9, 
  3.679195526612694*^9, 3.6794623450473757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"subMq", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"c1", "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
      RowBox[{
       RowBox[{"c2", "[", "t", "]"}], "\[Rule]", "0.13165249758739583`"}], 
      ",", 
      RowBox[{
       RowBox[{"z", "[", "t", "]"}], "\[Rule]", "0.3`"}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", "1.599525280781688`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", "1.817781925534272`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", "1.817781925534272`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", 
      RowBox[{"-", "1.0793166709573745`"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", "0.2712420549460831"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", 
      "0.2712420549460831`"}]}], "}"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{3.675995711351288*^9, 3.675998933771109*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2.1651610000000003`", "0.`", "0.`", 
      RowBox[{"-", "0.773980585789608`"}], "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "2.1651610000000003`", "0.`", "0.`", "0.02097854164312509`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "2.1651610000000003`", "0.`", "0.`", 
      "0.02097854164312509`", "0.`", "0.`", "0.`"},
     {
      RowBox[{"-", "0.773980585789608`"}], "0.`", "0.`", "1.0278361286225`", 
      "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.02097854164312509`", "0.`", "0.`", "1.0278361286225`", "0.`", 
      "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.02097854164312509`", "0.`", "0.`", "1.0278361286225`", 
      "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"0.9335735299034725`", " ", 
       RowBox[{"(", 
        RowBox[{"1.20268`", "\[VeryThinSpace]", "+", 
         RowBox[{"4.`", " ", "IPl1x"}], "+", 
         RowBox[{"4.`", " ", "IPl2x"}], "+", 
         RowBox[{"240.`", " ", 
          SuperscriptBox["yPl1", "2"]}], "+", 
         RowBox[{"480.`", " ", 
          SuperscriptBox["yPl2", "2"]}], "+", 
         RowBox[{"5.2068445889003116`*^-6", " ", 
          RowBox[{"(", 
           RowBox[{"275.252905896`", "\[VeryThinSpace]", "+", 
            RowBox[{"4.`", " ", "IPl1z"}], "+", 
            RowBox[{"4.`", " ", "IPl2z"}], "-", 
            RowBox[{"287.52`", " ", "xPl1"}], "+", 
            RowBox[{"240.`", " ", 
             SuperscriptBox["xPl1", "2"]}], "-", 
            RowBox[{"575.04`", " ", "xPl2"}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["xPl2", "2"]}], "+", 
            RowBox[{"240.`", " ", 
             SuperscriptBox["yPl1", "2"]}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["yPl2", "2"]}]}], ")"}]}], "+", 
         RowBox[{"240.`", " ", 
          SuperscriptBox["zPl1", "2"]}], "+", 
         RowBox[{"480.`", " ", 
          SuperscriptBox["zPl2", "2"]}], "+", 
         RowBox[{"0.002281851132063683`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"575.04`", " ", "zPl1"}], "-", 
            RowBox[{"960.`", " ", "xPl1", " ", "zPl1"}], "+", 
            RowBox[{"1150.08`", " ", "zPl2"}], "-", 
            RowBox[{"1920.`", " ", "xPl2", " ", "zPl2"}]}], ")"}]}], "+", 
         RowBox[{"0.13169204749859628`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"287.52`", " ", "zPl1"}], "-", 
            RowBox[{"480.`", " ", "xPl1", " ", "zPl1"}], "+", 
            RowBox[{"575.04`", " ", "zPl2"}], "-", 
            RowBox[{"960.`", " ", "xPl2", " ", "zPl2"}]}], ")"}]}], "+", 
         RowBox[{"0.0003004114006588105`", " ", 
          RowBox[{"(", 
           RowBox[{"551.708491792`", "\[VeryThinSpace]", "+", 
            RowBox[{"4.`", " ", "IPl1x"}], "+", 
            RowBox[{"8.`", " ", "IPl1z"}], "+", 
            RowBox[{"4.`", " ", "IPl2x"}], "+", 
            RowBox[{"8.`", " ", "IPl2z"}], "-", 
            RowBox[{"575.04`", " ", "xPl1"}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["xPl1", "2"]}], "-", 
            RowBox[{"1150.08`", " ", "xPl2"}], "+", 
            RowBox[{"960.`", " ", 
             SuperscriptBox["xPl2", "2"]}], "+", 
            RowBox[{"720.`", " ", 
             SuperscriptBox["yPl1", "2"]}], "+", 
            RowBox[{"1440.`", " ", 
             SuperscriptBox["yPl2", "2"]}], "+", 
            RowBox[{"240.`", " ", 
             SuperscriptBox["zPl1", "2"]}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["zPl2", "2"]}]}], ")"}]}], "+", 
         RowBox[{"0.017332380120999264`", " ", 
          RowBox[{"(", 
           RowBox[{"277.658265896`", "\[VeryThinSpace]", "+", 
            RowBox[{"8.`", " ", "IPl1x"}], "+", 
            RowBox[{"4.`", " ", "IPl1z"}], "+", 
            RowBox[{"8.`", " ", "IPl2x"}], "+", 
            RowBox[{"4.`", " ", "IPl2z"}], "-", 
            RowBox[{"287.52`", " ", "xPl1"}], "+", 
            RowBox[{"240.`", " ", 
             SuperscriptBox["xPl1", "2"]}], "-", 
            RowBox[{"575.04`", " ", "xPl2"}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["xPl2", "2"]}], "+", 
            RowBox[{"720.`", " ", 
             SuperscriptBox["yPl1", "2"]}], "+", 
            RowBox[{"1440.`", " ", 
             SuperscriptBox["yPl2", "2"]}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["zPl1", "2"]}], "+", 
            RowBox[{"960.`", " ", 
             SuperscriptBox["zPl2", "2"]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "3.73429411961389`"}], " ", 
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"1.0173323801209992`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"60.`", " ", "xPl1", " ", "yPl1"}], "+", 
            RowBox[{"120.`", " ", "xPl2", " ", "yPl2"}], "+", 
            RowBox[{"0.017332380120999264`", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"60.`", " ", 
                RowBox[{"(", 
                 RowBox[{"0.599`", "\[VeryThinSpace]", "+", "xPl1"}], ")"}], 
                " ", "yPl1"}], "+", 
               RowBox[{"120.`", " ", 
                RowBox[{"(", 
                 RowBox[{"0.599`", "\[VeryThinSpace]", "+", "xPl2"}], ")"}], 
                " ", "yPl2"}]}], ")"}]}], "+", 
            RowBox[{"0.13393434871945953`", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"60.`", " ", "yPl1", " ", "zPl1"}], "+", 
               RowBox[{"120.`", " ", "yPl2", " ", "zPl2"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], 
      RowBox[{"0.966216088617589`", " ", 
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"120.`", " ", "yPl1"}], "+", 
         RowBox[{"240.`", " ", "yPl2"}], "+", 
         RowBox[{"0.017332380120999264`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"120.`", " ", "yPl1"}], "+", 
            RowBox[{"240.`", " ", "yPl2"}]}], ")"}]}]}], ")"}]}]},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{
       RowBox[{"-", "3.73429411961389`"}], " ", 
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"1.0173323801209992`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"60.`", " ", "xPl1", " ", "yPl1"}], "+", 
            RowBox[{"120.`", " ", "xPl2", " ", "yPl2"}], "+", 
            RowBox[{"0.017332380120999264`", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"60.`", " ", 
                RowBox[{"(", 
                 RowBox[{"0.599`", "\[VeryThinSpace]", "+", "xPl1"}], ")"}], 
                " ", "yPl1"}], "+", 
               RowBox[{"120.`", " ", 
                RowBox[{"(", 
                 RowBox[{"0.599`", "\[VeryThinSpace]", "+", "xPl2"}], ")"}], 
                " ", "yPl2"}]}], ")"}]}], "+", 
            RowBox[{"0.13393434871945953`", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"60.`", " ", "yPl1", " ", "zPl1"}], "+", 
               RowBox[{"120.`", " ", "yPl2", " ", "zPl2"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], 
      RowBox[{"0.9335735299034725`", " ", 
       RowBox[{"(", 
        RowBox[{"1.20268`", "\[VeryThinSpace]", "+", 
         RowBox[{"4.`", " ", "IPl1y"}], "+", 
         RowBox[{"4.`", " ", "IPl2y"}], "+", 
         RowBox[{"240.`", " ", 
          SuperscriptBox["xPl1", "2"]}], "+", 
         RowBox[{"480.`", " ", 
          SuperscriptBox["xPl2", "2"]}], "+", 
         RowBox[{"240.`", " ", 
          SuperscriptBox["zPl1", "2"]}], "+", 
         RowBox[{"0.13165249758739583`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "287.52`"}], " ", "zPl1"}], "-", 
            RowBox[{"575.04`", " ", "zPl2"}]}], ")"}]}], "+", 
         RowBox[{"480.`", " ", 
          SuperscriptBox["zPl2", "2"]}], "+", 
         RowBox[{"0.002281851132063683`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"287.52`", " ", "zPl1"}], "+", 
            RowBox[{"575.04`", " ", "zPl2"}]}], ")"}]}], "+", 
         RowBox[{"0.0003004114006588105`", " ", 
          RowBox[{"(", 
           RowBox[{"1.20268`", "\[VeryThinSpace]", "+", 
            RowBox[{"4.`", " ", "IPl1y"}], "+", 
            RowBox[{"4.`", " ", "IPl2y"}], "+", 
            RowBox[{"240.`", " ", 
             SuperscriptBox["xPl1", "2"]}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["xPl2", "2"]}], "+", 
            RowBox[{"240.`", " ", 
             SuperscriptBox["zPl1", "2"]}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["zPl2", "2"]}]}], ")"}]}], "+", 
         RowBox[{"0.017332380120999264`", " ", 
          RowBox[{"(", 
           RowBox[{"275.48736589600003`", "\[VeryThinSpace]", "+", 
            RowBox[{"8.`", " ", "IPl1y"}], "+", 
            RowBox[{"8.`", " ", "IPl2y"}], "+", 
            RowBox[{"575.04`", " ", "xPl1"}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["xPl1", "2"]}], "+", 
            RowBox[{"1150.08`", " ", "xPl2"}], "+", 
            RowBox[{"960.`", " ", 
             SuperscriptBox["xPl2", "2"]}], "+", 
            RowBox[{"480.`", " ", 
             SuperscriptBox["zPl1", "2"]}], "+", 
            RowBox[{"960.`", " ", 
             SuperscriptBox["zPl2", "2"]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"0.966216088617589`", " ", 
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"120.`", " ", "xPl1"}], "-", 
         RowBox[{"240.`", " ", "xPl2"}], "+", 
         RowBox[{"0.017332380120999264`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"120.`", " ", "xPl1"}], "+", 
            RowBox[{"240.`", " ", "xPl2"}]}], ")"}]}], "+", 
         RowBox[{"0.13165249758739583`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "240.`"}], " ", "zPl1"}], "-", 
            RowBox[{"480.`", " ", "zPl2"}]}], ")"}]}]}], ")"}]}]},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"0.966216088617589`", " ", 
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "+", 
         RowBox[{"120.`", " ", "yPl1"}], "+", 
         RowBox[{"240.`", " ", "yPl2"}], "+", 
         RowBox[{"0.017332380120999264`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"120.`", " ", "yPl1"}], "+", 
            RowBox[{"240.`", " ", "yPl2"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"0.966216088617589`", " ", 
       RowBox[{"(", 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"120.`", " ", "xPl1"}], "-", 
         RowBox[{"240.`", " ", "xPl2"}], "+", 
         RowBox[{"0.017332380120999264`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"120.`", " ", "xPl1"}], "+", 
            RowBox[{"240.`", " ", "xPl2"}]}], ")"}]}], "+", 
         RowBox[{"0.13165249758739583`", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "240.`"}], " ", "zPl1"}], "-", 
            RowBox[{"480.`", " ", "zPl2"}]}], ")"}]}]}], ")"}]}], "190.274`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.675999058893978*^9, 3.67605768047253*^9, 
  3.676058120549712*^9, 3.676058436357222*^9, 3.676084230598741*^9, 
  3.6760852628006144`*^9, 3.676096567648614*^9, 3.679195526731658*^9, 
  3.67946234522213*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", 
  RowBox[{
   RowBox[{"M\[Theta]", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"c1", "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
      RowBox[{
       RowBox[{"c2", "[", "t", "]"}], "\[Rule]", "0.13165249758739583`"}], 
      ",", 
      RowBox[{
       RowBox[{"z", "[", "t", "]"}], "\[Rule]", "0.3`"}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", "1.599525280781688`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", "1.817781925534272`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", "1.817781925534272`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", 
      RowBox[{"-", "1.0793166709573745`"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", "0.2712420549460831"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", 
      "0.2712420549460831`"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.6759990485940027`*^9}],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "M\[Theta]", "]"}]], "Output",
 CellChangeTimes->{3.675999087220583*^9, 3.676058120616905*^9, 
  3.676058436455864*^9, 3.6760842278020782`*^9, 3.676085262927497*^9, 
  3.676096567714204*^9, 3.679195526832796*^9, 3.679462345453308*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"NDSolve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"massMatrix", "[", 
           RowBox[{
            RowBox[{"q1", "[", "t", "]"}], ",", "t"}], "]"}], ".", 
          RowBox[{
           RowBox[{"q1", "''"}], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"cMatrix", "[", 
           RowBox[{
            RowBox[{"q1", "[", "t", "]"}], ",", 
            RowBox[{
             RowBox[{"q1", "'"}], "[", "t", "]"}], ",", "t"}], "]"}], ".", 
          RowBox[{
           RowBox[{"q1", "'"}], "[", "t", "]"}]}], "+", 
         RowBox[{"gMatrix", "[", 
          RowBox[{
           RowBox[{"q1", "[", "t", "]"}], ",", "t"}], "]"}], "-", 
         RowBox[{"calcQc", "[", 
          RowBox[{
           RowBox[{"q1", "[", "t", "]"}], ",", 
           RowBox[{
            RowBox[{"q1", "'"}], "[", "t", "]"}], ",", "t"}], "]"}]}], ")"}], 
       "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"q1", "[", "0", "]"}], "\[Equal]", "qval"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"q1", "'"}], "[", "0", "]"}], "\[Equal]", "dqval"}]}], "}"}], 
    ",", "q1", ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "0.1"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NDSolve", "::", "ntdvdae"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Cannot solve to find an explicit formula for the \
derivatives. NDSolve will try solving the system as differential-algebraic \
equations. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/NDSolve\\\", ButtonNote \
-> \\\"NDSolve::ntdvdae\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.676057709765905*^9, 3.6760579699480553`*^9, 3.6760581207370853`*^9, 
   3.676058436629249*^9, {3.676058533079471*^9, 3.676058541551672*^9}, 
   3.676084216975533*^9, 3.676085034492701*^9, 3.676085263354895*^9, 
   3.676096568044002*^9, 3.679195527305421*^9, 3.679462345775427*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\








Inverse Kinematics\
\>", "Section",
 CellChangeTimes->{{3.6242996411342707`*^9, 3.624299662112124*^9}, 
   3.624299731584939*^9, 3.632753152788018*^9, 3.634482640891058*^9, {
   3.675776804364703*^9, 3.675776805270667*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rrdyad", "[", 
     RowBox[{"l1_", ",", "l2_", ",", 
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ang1_", ",", "ang2_"}], "}"}]}], "]"}], ":=", " ", "\n", "\n", 
    RowBox[{"(*", 
     RowBox[{
     "Inputs", " ", "are", " ", "the", " ", "link", " ", "parameters", " ", 
      "and", " ", "an", " ", "operator", " ", "x", " ", "which", " ", 
      "decides", " ", "which", " ", "output", " ", "has", " ", "to", " ", 
      "be", " ", "returned"}], "*)"}], "\n", 
    RowBox[{"(*", " ", 
     RowBox[{"Solves", " ", "for", " ", "an", " ", "RR", " ", "dyad"}], 
     "*)"}], "\n", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "\[Theta]1a", ",", " ", "\[Theta]2a", ",", " ", "\[Theta]1b",
         ",", " ", "\[Theta]2b", ",", "ret"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2"}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y1", "-", "y2"}], ")"}], "^", "2"}]}], "]"}]}], ";", 
       "\n", 
       RowBox[{"\[Theta]1a", "=", 
        RowBox[{"ang1", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ArcCos", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l1", "^", "2"}], "+", 
               RowBox[{"d", "^", "2"}], "-", 
               RowBox[{"l2", "^", "2"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "d", "*", "l1"}], ")"}]}], "]"}]}], "+", 
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"x2", "-", "x1"}], ",", 
            RowBox[{"y2", "-", "y1"}]}], "]"}]}]}]}], ";", "\n", 
       RowBox[{"\[Theta]2a", "=", 
        RowBox[{"ang2", "\[Rule]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ArcTan", "[", 
             RowBox[{
              RowBox[{"x2", "-", 
               RowBox[{"l1", "*", 
                RowBox[{"Cos", "[", "ang1", "]"}]}], "-", "x1"}], ",", 
              RowBox[{"y2", "-", 
               RowBox[{"l1", "*", 
                RowBox[{"Sin", "[", "ang1", "]"}]}], "-", "y1"}]}], "]"}], 
            ")"}], "/.", "\[Theta]1a"}], ")"}]}]}], ";", "\n", 
       RowBox[{"\[Theta]1b", "=", 
        RowBox[{"ang1", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"+", 
           RowBox[{"ArcCos", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l1", "^", "2"}], "+", 
               RowBox[{"d", "^", "2"}], "-", 
               RowBox[{"l2", "^", "2"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "d", "*", "l1"}], ")"}]}], "]"}]}], "+", 
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"x2", "-", "x1"}], ",", 
            RowBox[{"y2", "-", "y1"}]}], "]"}]}]}]}], ";", "\n", 
       RowBox[{"\[Theta]2b", "=", 
        RowBox[{"ang2", "\[Rule]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ArcTan", "[", 
             RowBox[{
              RowBox[{"x2", "-", 
               RowBox[{"l1", "*", 
                RowBox[{"Cos", "[", "ang1", "]"}]}], "-", "x1"}], ",", 
              RowBox[{"y2", "-", 
               RowBox[{"l1", "*", 
                RowBox[{"Sin", "[", "ang1", "]"}]}], "-", "y1"}]}], "]"}], 
            ")"}], "/.", "\[Theta]1b"}], ")"}]}]}], ";", "\n", 
       RowBox[{"ret", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]1a", ",", "\[Theta]2a"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]1b", ",", "\[Theta]2b"}], "}"}]}], "}"}]}], ";", 
       "\n", 
       RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6242997003240623`*^9, 3.6242997078572187`*^9}, {
  3.628915022969882*^9, 3.62891504211263*^9}, {3.628952391446117*^9, 
  3.6289524089081984`*^9}, {3.639277516663643*^9, 3.6392775168886423`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inverseKinematics03RRS", "[", 
  RowBox[{"0", ",", 
   RowBox[{"Tan", "[", 
    RowBox[{"\[Pi]", "/", "12"}], "]"}], ",", "0.3", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rb", ",", "lcr", ",", "lst", ",", "ra"}], "}"}], "/.", 
    "linklength"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.675781912670917*^9, 3.6757819284811783`*^9}, 
   3.675781964723341*^9, {3.6759962420393457`*^9, 3.675996246486848*^9}, {
   3.6759962868338947`*^9, 3.67599639559986*^9}, 3.675998091009609*^9, {
   3.675998187625988*^9, 3.6759982339139233`*^9}, {3.675998402476416*^9, 
   3.6759984061958237`*^9}, 3.675998454751371*^9}],

Cell[BoxData[
 RowBox[{"inverseKinematics03RRS", "[", 
  RowBox[{"0", ",", 
   RowBox[{"2", "-", 
    SqrtBox["3"]}], ",", "0.3`", ",", 
   RowBox[{"{", 
    RowBox[{"0.3`", ",", "0.4`", ",", "0.3533`", ",", "0.599`"}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.6759964752907047`*^9, 3.675998092641656*^9, {3.675998200997848*^9, 
   3.675998234456002*^9}, {3.675998392152348*^9, 3.6759984071722383`*^9}, 
   3.6759984562591133`*^9, 3.676058122352839*^9, 3.676058438403981*^9, 
   3.67605865537853*^9, 3.676085265818577*^9, 3.676096570782804*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"0", "th", " ", "order", " ", "inverse", " ", "kinematcs"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"inverseKinematics03RRS", "[", 
     RowBox[{"c1_", ",", "c2_", ",", "z_", ",", 
      RowBox[{"{", 
       RowBox[{"rb_", ",", "lcr_", ",", "lst_", ",", "ra_"}], "}"}]}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p1", ",", "p2", ",", "p3", ",", "solleg1", ",", "solleg2", ",", 
        "solleg3"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["c1", "2"], "-", 
               SuperscriptBox["c2", "2"]}], ")"}], " ", "ra"}], 
            RowBox[{"1", "+", 
             SuperscriptBox["c1", "2"], "+", 
             SuperscriptBox["c2", "2"]}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["c1", "2"], "-", 
               SuperscriptBox["c2", "2"]}], ")"}], " ", "ra"}], 
            RowBox[{"1", "+", 
             SuperscriptBox["c1", "2"], "+", 
             SuperscriptBox["c2", "2"]}]]}], ",", "0", ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", "c2", " ", "ra"}], 
             RowBox[{"1", "+", 
              SuperscriptBox["c1", "2"], "+", 
              SuperscriptBox["c2", "2"]}]]}], "+", "z"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["c1", "2"], "+", 
               RowBox[{"2", " ", 
                SqrtBox["3"], " ", "c1", " ", "c2"}], "-", 
               SuperscriptBox["c2", "2"]}], ")"}], " ", "ra"}], 
            RowBox[{"1", "+", 
             SuperscriptBox["c1", "2"], "+", 
             SuperscriptBox["c2", "2"]}]]}], ",", "0", ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             SqrtBox["3"], " ", "c1", " ", "ra"}], "+", 
            RowBox[{"c2", " ", "ra"}], "+", "z", "+", 
            RowBox[{
             SuperscriptBox["c1", "2"], " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["c2", "2"], " ", "z"}]}], 
           RowBox[{"1", "+", 
            SuperscriptBox["c1", "2"], "+", 
            SuperscriptBox["c2", "2"]}]]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["c1", "2"], "+", 
              RowBox[{"2", " ", 
               SqrtBox["3"], " ", "c1", " ", "c2"}], "+", 
              SuperscriptBox["c2", "2"]}], ")"}], " ", "ra"}], 
           RowBox[{"1", "+", 
            SuperscriptBox["c1", "2"], "+", 
            SuperscriptBox["c2", "2"]}]], ",", "0", ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SqrtBox["3"]}], " ", "c1", " ", "ra"}], "+", 
            RowBox[{"c2", " ", "ra"}], "+", "z", "+", 
            RowBox[{
             SuperscriptBox["c1", "2"], " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["c2", "2"], " ", "z"}]}], 
           RowBox[{"1", "+", 
            SuperscriptBox["c1", "2"], "+", 
            SuperscriptBox["c2", "2"]}]]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"solleg1", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"rrdyad", "[", 
          RowBox[{"lcr", ",", "lst", ",", 
           RowBox[{"{", 
            RowBox[{"rb", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"p1", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]1", ",", "\[Phi]1"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"solleg2", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"rrdyad", "[", 
          RowBox[{"lcr", ",", "lst", ",", 
           RowBox[{"{", 
            RowBox[{"rb", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"p2", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]2", ",", "\[Phi]2"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"solleg3", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"rrdyad", "[", 
          RowBox[{"lcr", ",", "lst", ",", 
           RowBox[{"{", 
            RowBox[{"rb", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p3", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"p3", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]3", ",", "\[Phi]3"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"solleg1", ",", "solleg2", ",", "solleg3"}], "}"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.624307324325376*^9, 3.624307334906157*^9}, {
  3.634468651551743*^9, 3.634468686928492*^9}, {3.675781967462357*^9, 
  3.675781969054125*^9}, {3.6757820803730373`*^9, 3.6757821067263002`*^9}, {
  3.675782164258504*^9, 3.675782202067045*^9}, {3.6757823385333433`*^9, 
  3.675782341154132*^9}, {3.675782375967547*^9, 3.675782467308743*^9}, {
  3.675996435252246*^9, 3.6759964697979927`*^9}, {3.6760926499415894`*^9, 
  3.676092665497788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"1", "st", " ", "order", " ", "inverse", " ", "kinematcs"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"inverseKinematics13RRS", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]x_", ",", "\[Alpha]y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Omega]x_", ",", "\[Omega]y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]kx_", ",", "\[Phi]ky_"}], "}"}], ",", "\[Phi]_", ",", 
      "valz_", ",", "dz_", ",", "ddz_", ",", 
      RowBox[{"{", 
       RowBox[{"rb_", ",", "lcr_", ",", "lst_", ",", "ra_"}], "}"}]}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "valc", ",", "subscz", ",", "p1a", ",", "p2a", ",", "p3a", ",", 
        "solleg1", ",", "solleg2", ",", "solleg3", ",", "subs\[Beta]", ",", 
        "\[Eta]", ",", "x", ",", "dx", ",", "ddx", ",", "\[Beta]", ",", 
        "d\[Beta]", ",", "J\[Eta]\[Beta]", ",", "dJ\[Eta]\[Beta]", ",", 
        "J\[Eta]x", ",", "dJ\[Eta]x", ",", "valdc", ",", "subsdcz", ",", 
        "valddc", ",", "subsddcz", ",", "vald\[Beta]", ",", "subsd\[Beta]", 
        ",", "valdd\[Beta]", ",", "subsdd\[Beta]"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"valc", "=", 
        RowBox[{
         RowBox[{"Tan", "[", 
          RowBox[{"\[Phi]", "/", "2"}], "]"}], "*", 
         RowBox[{"{", 
          RowBox[{"\[Phi]kx", ",", "\[Phi]ky"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subscz", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"c1", "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valc", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"c2", "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valc", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"z", "[", "t", "]"}], "\[Rule]", " ", "valz"}]}], "}"}]}], 
       ";", 
       RowBox[{"p1a", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ra", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ")"}],
              "/", 
             RowBox[{"(", 
              RowBox[{"1", " ", "+", " ", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", 
            "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ra", "*", 
               RowBox[{"(", 
                RowBox[{"1", " ", "+", " ", 
                 RowBox[{
                  RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ")"}],
              "/", 
             RowBox[{"(", 
              RowBox[{"1", " ", "+", " ", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], ",", 
           " ", "0", ",", " ", 
           RowBox[{
            RowBox[{"z", "[", "t", "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "*", "ra", "*", 
               RowBox[{"c2", "[", "t", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", " ", "+", " ", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}]}], 
          "}"}], "/.", "subscz"}]}], ";", "\n", "\t", 
       RowBox[{"p2a", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ra", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], " ", "+", " ", 
                  RowBox[{
                   RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
                  RowBox[{"2", "*", 
                   RowBox[{"Sqrt", "[", "3", "]"}], "*", 
                   RowBox[{"c1", "[", "t", "]"}], "*", 
                   RowBox[{"c2", "[", "t", "]"}]}], " ", "-", " ", 
                  RowBox[{
                   RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], 
               ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"1", " ", "+", " ", 
                RowBox[{
                 RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
                RowBox[{
                 RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], 
             ")"}]}], ",", " ", "0", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "[", "t", "]"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"Sqrt", "[", "3", "]"}], "*", "ra", "*", 
               RowBox[{"c1", "[", "t", "]"}]}], " ", "+", " ", 
              RowBox[{
               RowBox[{"z", "[", "t", "]"}], "*", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], "^", "2"}]}], " ", "+", " ", 
              RowBox[{"ra", "*", 
               RowBox[{"c2", "[", "t", "]"}]}], " ", "+", " ", 
              RowBox[{
               RowBox[{"z", "[", "t", "]"}], "*", 
               RowBox[{
                RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", " ", "+", " ", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], "}"}], 
         "/.", "subscz"}]}], ";", "\n", "\t", 
       RowBox[{"p3a", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ra", "*", 
              RowBox[{"(", 
               RowBox[{"1", " ", "-", " ", 
                RowBox[{
                 RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
                RowBox[{"2", "*", 
                 RowBox[{"Sqrt", "[", "3", "]"}], "*", 
                 RowBox[{"c1", "[", "t", "]"}], "*", 
                 RowBox[{"c2", "[", "t", "]"}]}], " ", "+", " ", 
                RowBox[{
                 RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ")"}], 
            "/", 
            RowBox[{"(", 
             RowBox[{"1", " ", "+", " ", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ",", " ",
            "0", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "[", "t", "]"}], " ", "-", " ", 
              RowBox[{
               RowBox[{"Sqrt", "[", "3", "]"}], "*", "ra", "*", 
               RowBox[{"c1", "[", "t", "]"}]}], " ", "+", " ", 
              RowBox[{
               RowBox[{"z", "[", "t", "]"}], "*", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], "^", "2"}]}], " ", "+", " ", 
              RowBox[{"ra", "*", 
               RowBox[{"c2", "[", "t", "]"}]}], " ", "+", " ", 
              RowBox[{
               RowBox[{"z", "[", "t", "]"}], "*", 
               RowBox[{
                RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", " ", "+", " ", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], "}"}], 
         "/.", "subscz"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solleg1", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"rrdyad", "[", 
          RowBox[{"lcr", ",", "lst", ",", 
           RowBox[{"{", 
            RowBox[{"rb", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p1a", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"p1a", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
             RowBox[{"\[Phi]1", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"solleg2", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"rrdyad", "[", 
          RowBox[{"lcr", ",", "lst", ",", 
           RowBox[{"{", 
            RowBox[{"rb", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p2a", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"p2a", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Theta]2", "[", "t", "]"}], ",", 
             RowBox[{"\[Phi]2", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"solleg3", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"rrdyad", "[", 
          RowBox[{"lcr", ",", "lst", ",", 
           RowBox[{"{", 
            RowBox[{"rb", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p3a", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"p3a", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Theta]3", "[", "t", "]"}], ",", 
             RowBox[{"\[Phi]3", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"subs\[Beta]", "=", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"solleg1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solleg2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"solleg3", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Eta]", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ra", "-", "rb", "+", 
           RowBox[{"2", " ", "ra", " ", 
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"rb", " ", 
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"2", " ", "ra", " ", 
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"rb", " ", 
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"lcr", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"lst", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "ra", " ", 
            RowBox[{"c2", "[", "t", "]"}]}], "-", 
           RowBox[{"lcr", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"lst", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"z", "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"], " ", 
            RowBox[{"z", "[", "t", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
            RowBox[{"z", "[", "t", "]"}]}]}], ",", 
          RowBox[{"ra", "-", "rb", "-", 
           RowBox[{"ra", " ", 
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"rb", " ", 
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"2", " ", 
            SqrtBox["3"], " ", "ra", " ", 
            RowBox[{"c1", "[", "t", "]"}], " ", 
            RowBox[{"c2", "[", "t", "]"}]}], "+", 
           RowBox[{"ra", " ", 
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"rb", " ", 
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"lcr", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"lst", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            SqrtBox["3"], " ", "ra", " ", 
            RowBox[{"c1", "[", "t", "]"}]}], "+", 
           RowBox[{"ra", " ", 
            RowBox[{"c2", "[", "t", "]"}]}], "-", 
           RowBox[{"lcr", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"lst", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"z", "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"], " ", 
            RowBox[{"z", "[", "t", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
            RowBox[{"z", "[", "t", "]"}]}]}], ",", 
          RowBox[{"ra", "-", "rb", "-", 
           RowBox[{"ra", " ", 
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"rb", " ", 
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"]}], "+", 
           RowBox[{"2", " ", 
            SqrtBox["3"], " ", "ra", " ", 
            RowBox[{"c1", "[", "t", "]"}], " ", 
            RowBox[{"c2", "[", "t", "]"}]}], "+", 
           RowBox[{"ra", " ", 
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"rb", " ", 
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"]}], "-", 
           RowBox[{"lcr", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"lst", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SqrtBox["3"]}], " ", "ra", " ", 
            RowBox[{"c1", "[", "t", "]"}]}], "+", 
           RowBox[{"ra", " ", 
            RowBox[{"c2", "[", "t", "]"}]}], "-", 
           RowBox[{"lcr", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"lst", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]3", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"z", "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"], " ", 
            RowBox[{"z", "[", "t", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
            RowBox[{"z", "[", "t", "]"}]}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c1", "[", "t", "]"}], ",", 
          RowBox[{"c2", "[", "t", "]"}], ",", 
          RowBox[{"z", "[", "t", "]"}]}], "}"}]}], ";", "\n", "\t", 
       RowBox[{"dx", "=", 
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ddx", "=", 
        RowBox[{"D", "[", 
         RowBox[{"dx", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Beta]", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
          RowBox[{"\[Theta]2", "[", "t", "]"}], ",", 
          RowBox[{"\[Theta]3", "[", "t", "]"}], ",", 
          RowBox[{"\[Phi]1", "[", "t", "]"}], ",", 
          RowBox[{"\[Phi]2", "[", "t", "]"}], ",", 
          RowBox[{"\[Phi]3", "[", "t", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d\[Beta]", "=", 
        RowBox[{"D", "[", 
         RowBox[{"\[Beta]", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"J\[Eta]\[Beta]", "=", 
        RowBox[{"D", "[", 
         RowBox[{"\[Eta]", ",", 
          RowBox[{"{", "\[Beta]", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dJ\[Eta]\[Beta]", "=", 
        RowBox[{"D", "[", 
         RowBox[{"J\[Eta]\[Beta]", ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"J\[Eta]x", "=", 
        RowBox[{"D", "[", 
         RowBox[{"\[Eta]", ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dJ\[Eta]x", "=", 
        RowBox[{"D", "[", 
         RowBox[{"J\[Eta]x", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"valdc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "2"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "*", 
          RowBox[{"{", 
           RowBox[{"\[Omega]x", ",", "\[Omega]y"}], "}"}]}], "/.", 
         "subscz"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"??", 
         RowBox[{"??", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"subsdcz", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"c1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valdc", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"c2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valdc", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"z", "'"}], "[", "t", "]"}], "\[Rule]", " ", "dz"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"valddc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"\[Alpha]x", "+", 
              FractionBox[
               RowBox[{"4", " ", 
                RowBox[{"c1", "[", "t", "]"}], " ", 
                SuperscriptBox[
                 RowBox[{
                  SuperscriptBox["c1", "\[Prime]",
                   MultilineFunction->None], "[", "t", "]"}], "2"]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]], "+", 
              FractionBox[
               RowBox[{"4", " ", 
                RowBox[{"c2", "[", "t", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["c1", "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["c2", "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}], 
             RowBox[{
              FractionBox["2", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]], "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"c1", "[", "t", "]"}], "2"]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]], "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"c2", "[", "t", "]"}], "2"]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}]], 
            ",", 
            FractionBox[
             RowBox[{"\[Alpha]y", "+", 
              FractionBox[
               RowBox[{"4", " ", 
                RowBox[{"c1", "[", "t", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["c1", "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["c2", "\[Prime]",
                  MultilineFunction->None], "[", "t", "]"}]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]], "+", 
              FractionBox[
               RowBox[{"4", " ", 
                RowBox[{"c2", "[", "t", "]"}], " ", 
                SuperscriptBox[
                 RowBox[{
                  SuperscriptBox["c2", "\[Prime]",
                   MultilineFunction->None], "[", "t", "]"}], "2"]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}], 
             RowBox[{
              FractionBox["2", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]], "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"c1", "[", "t", "]"}], "2"]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]], "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"c2", "[", "t", "]"}], "2"]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox[
                   RowBox[{"c1", "[", "t", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"c2", "[", "t", "]"}], "2"]}], ")"}], "2"]]}]]}], 
           "}"}], "/.", "subscz"}], "/.", "subsdcz"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subsddcz", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"c1", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valddc", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"c2", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valddc", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"z", "''"}], "[", "t", "]"}], "\[Rule]", " ", "ddz"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vald\[Beta]", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"Inverse", "[", "J\[Eta]\[Beta]", "]"}], ".", 
             RowBox[{"(", 
              RowBox[{"J\[Eta]x", ".", "dx"}], ")"}]}]}], "/.", 
           "subs\[Beta]"}], "/.", "subscz"}], "/.", "subsdcz"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subsd\[Beta]", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"vald\[Beta]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"vald\[Beta]", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]3", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"vald\[Beta]", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"vald\[Beta]", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"vald\[Beta]", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]3", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"vald\[Beta]", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"valdd\[Beta]", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               RowBox[{"Inverse", "[", "J\[Eta]\[Beta]", "]"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"J\[Eta]x", ".", "ddx"}], "+", 
                 RowBox[{"dJ\[Eta]x", ".", "dx"}], "+", 
                 RowBox[{"dJ\[Eta]\[Beta]", ".", "d\[Beta]"}]}], ")"}]}]}], "/.",
              "subs\[Beta]"}], "/.", "subsd\[Beta]"}], "/.", "subsdcz"}], "/.",
           "subscz"}], "/.", "subsddcz"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subsdd\[Beta]", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]1", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valdd\[Beta]", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]2", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valdd\[Beta]", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]3", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valdd\[Beta]", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]1", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valdd\[Beta]", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]2", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valdd\[Beta]", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]3", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
           RowBox[{"valdd\[Beta]", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "subscz", ",", "subs\[Beta]", ",", "subsdcz", ",", "subsd\[Beta]", 
          ",", "subsddcz", ",", "subsdd\[Beta]"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.624300593200704*^9, 3.624300594752069*^9}, {
   3.624307253946968*^9, 3.624307256584218*^9}, {3.6344686939638033`*^9, 
   3.634468700415237*^9}, {3.63446897699294*^9, 3.6344690020785723`*^9}, {
   3.634469064581078*^9, 3.634469116723939*^9}, {3.675781976364284*^9, 
   3.6757819828028383`*^9}, {3.6757835993570833`*^9, 3.675783601372037*^9}, {
   3.675786382237632*^9, 3.6757863867826843`*^9}, {3.675786417426715*^9, 
   3.675786432388*^9}, {3.675948601326624*^9, 3.675948663414205*^9}, {
   3.6759488920827007`*^9, 3.6759489525173903`*^9}, {3.675949059717792*^9, 
   3.67594906798857*^9}, {3.675949562234837*^9, 3.67594956422229*^9}, {
   3.6759496117538023`*^9, 3.675949677541005*^9}, {3.6759508916235313`*^9, 
   3.675950922113551*^9}, {3.6759520472453327`*^9, 3.675952100172598*^9}, {
   3.675952178910535*^9, 3.6759522117994423`*^9}, {3.675952945517961*^9, 
   3.675952946900242*^9}, 3.676085974353574*^9, 3.6760861557229147`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solinv", "=", 
  RowBox[{"N", "[", 
   RowBox[{"inverseKinematics13RRS", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", "0", ",", "0.2", ",", "0.2", ",", 
     "9.8", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rb", ",", "lcr", ",", "lst", ",", "ra"}], "}"}], "/.", 
      "data"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.676086123010168*^9, 3.676086137194954*^9}, 
   3.6760862298569117`*^9, 3.6760862639798098`*^9, 3.676086356824885*^9, {
   3.676086651850037*^9, 3.676086681269264*^9}, {3.676092451810527*^9, 
   3.676092493268796*^9}, {3.6760925372639627`*^9, 3.676092587675005*^9}, {
   3.676092696475711*^9, 3.676092717676256*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"c1", "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"c2", "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", "t", "]"}], "\[Rule]", "0.2`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", 
      RowBox[{"-", "0.37243404494529375`"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", 
      RowBox[{"-", "0.37243404494529375`"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", 
      RowBox[{"-", "0.37243404494529375`"}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", "1.7805904958488534`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", "1.7805904958488534`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", 
      "1.7805904958488534`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["c1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.2`"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "0.5855050249349895`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "0.5855050249349895`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]3", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "0.5855050249349895`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "0.24662547727122328`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "0.24662547727122328`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]3", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "0.24662547727122328`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["c1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "9.8`"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "28.528370922242267`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "28.528370922242267`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]3", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "28.528370922242267`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "11.659998916600703`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "11.659998916600703`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Phi]3", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "11.659998916600703`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.676092590436957*^9, {3.6760926986474953`*^9, 3.676092719340023*^9}, 
   3.676092801239896*^9, 3.676096571214294*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inverse Kinematics 2nd Order Task space", "Section",
 CellChangeTimes->{{3.6242996411342707`*^9, 3.624299662112124*^9}, 
   3.624299731584939*^9, 3.632753152788018*^9, 3.634482640891058*^9, {
   3.665370966310848*^9, 3.66537097651334*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"inverseKinematics23RRS", "[", 
    RowBox[{"valdd\[Theta]_", ",", "vald\[Theta]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]kx_", ",", "\[Phi]ky_"}], "}"}], ",", "\[Phi]_", ",", 
     "valz_", ",", 
     RowBox[{"{", 
      RowBox[{"rb_", ",", "lcr_", ",", "lst_", ",", "ra_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Theta]", ",", "d\[Theta]", ",", "dd\[Theta]", ",", "valc", ",", 
       "subscz", ",", "p1a", ",", "p2a", ",", "p3a", ",", "solleg1", ",", 
       "solleg2", ",", "solleg3", ",", "subs\[Beta]", ",", "subsd\[Theta]", 
       ",", "subsdd\[Theta]", ",", "\[Eta]", ",", "x", ",", "dx", ",", "ddx", 
       ",", "J\[Eta]\[Theta]", ",", "dJ\[Eta]\[Theta]", ",", "J\[Eta]x", ",", 
       "dJ\[Eta]x", ",", "valdx", ",", "valddx", ",", "subsdx", ",", 
       "subsddx"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"valc", "=", 
       RowBox[{
        RowBox[{"Tan", "[", 
         RowBox[{"\[Phi]", "/", "2"}], "]"}], "*", 
        RowBox[{"{", 
         RowBox[{"\[Phi]kx", ",", "\[Phi]ky"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"subscz", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"c1", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valc", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"c2", "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valc", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"z", "[", "t", "]"}], "\[Rule]", " ", "valz"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"p1a", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ra", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                RowBox[{
                 RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ")"}], 
            "/", 
            RowBox[{"(", 
             RowBox[{"1", " ", "+", " ", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", "+",
            " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ra", "*", 
              RowBox[{"(", 
               RowBox[{"1", " ", "+", " ", 
                RowBox[{
                 RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "-", " ", 
                RowBox[{
                 RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ")"}], 
            "/", 
            RowBox[{"(", 
             RowBox[{"1", " ", "+", " ", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], ",", 
          " ", "0", ",", " ", 
          RowBox[{
           RowBox[{"z", "[", "t", "]"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "*", "ra", "*", 
              RowBox[{"c2", "[", "t", "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", " ", "+", " ", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}]}], 
         "}"}], "/.", "subscz"}]}], ";", "\n", "\t", 
      RowBox[{"p2a", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ra", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], " ", "+", " ", 
                 RowBox[{
                  RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
                 RowBox[{"2", "*", 
                  RowBox[{"Sqrt", "[", "3", "]"}], "*", 
                  RowBox[{"c1", "[", "t", "]"}], "*", 
                  RowBox[{"c2", "[", "t", "]"}]}], " ", "-", " ", 
                 RowBox[{
                  RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ")"}],
              "/", 
             RowBox[{"(", 
              RowBox[{"1", " ", "+", " ", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
               RowBox[{
                RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ")"}]}],
           ",", " ", "0", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "[", "t", "]"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], "*", "ra", "*", 
              RowBox[{"c1", "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"z", "[", "t", "]"}], "*", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], "^", "2"}]}], " ", "+", " ", 
             RowBox[{"ra", "*", 
              RowBox[{"c2", "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"z", "[", "t", "]"}], "*", 
              RowBox[{
               RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{
              RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], "}"}], "/.",
         "subscz"}]}], ";", "\n", "\t", 
      RowBox[{"p3a", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ra", "*", 
             RowBox[{"(", 
              RowBox[{"1", " ", "-", " ", 
               RowBox[{
                RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
               RowBox[{"2", "*", 
                RowBox[{"Sqrt", "[", "3", "]"}], "*", 
                RowBox[{"c1", "[", "t", "]"}], "*", 
                RowBox[{"c2", "[", "t", "]"}]}], " ", "+", " ", 
               RowBox[{
                RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ")"}], 
           "/", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{
              RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}], ",", " ", 
          "0", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "[", "t", "]"}], " ", "-", " ", 
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], "*", "ra", "*", 
              RowBox[{"c1", "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"z", "[", "t", "]"}], "*", 
              RowBox[{
               RowBox[{"c1", "[", "t", "]"}], "^", "2"}]}], " ", "+", " ", 
             RowBox[{"ra", "*", 
              RowBox[{"c2", "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"z", "[", "t", "]"}], "*", 
              RowBox[{
               RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{
              RowBox[{"c1", "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
             RowBox[{
              RowBox[{"c2", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}], "}"}], "/.",
         "subscz"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solleg1", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"rrdyad", "[", 
         RowBox[{"lcr", ",", "lst", ",", 
          RowBox[{"{", 
           RowBox[{"rb", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p1a", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"p1a", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
            RowBox[{"\[Phi]1", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"solleg2", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"rrdyad", "[", 
         RowBox[{"lcr", ",", "lst", ",", 
          RowBox[{"{", 
           RowBox[{"rb", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p2a", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"p2a", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]2", "[", "t", "]"}], ",", 
            RowBox[{"\[Phi]2", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"solleg3", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"rrdyad", "[", 
         RowBox[{"lcr", ",", "lst", ",", 
          RowBox[{"{", 
           RowBox[{"rb", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p3a", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"p3a", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]3", "[", "t", "]"}], ",", 
            RowBox[{"\[Phi]3", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"subs\[Beta]", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"solleg1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"solleg2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"solleg3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["lcr", "2"], "-", 
          SuperscriptBox["lst", "2"], "+", 
          SuperscriptBox["ra", "2"], "-", 
          RowBox[{"2", " ", "ra", " ", "rb"}], "+", 
          SuperscriptBox["rb", "2"], "-", 
          RowBox[{"2", " ", "lcr", " ", "ra", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "lcr", " ", "rb", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"4", " ", "ra", " ", 
           RowBox[{"c2", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{"4", " ", "ra", " ", 
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "lcr", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"z", "[", "t", "]"}]}], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", "t", "]"}], "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c1", "[", "t", "]"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["lcr", "2"], "-", 
             SuperscriptBox["lst", "2"], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["ra", "2"]}], "-", 
             RowBox[{"4", " ", "ra", " ", "rb"}], "+", 
             SuperscriptBox["rb", "2"], "+", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "ra"}], "+", "rb"}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["lcr", "2"], "-", 
             SuperscriptBox["lst", "2"], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["ra", "2"]}], "+", 
             RowBox[{"4", " ", "ra", " ", "rb"}], "+", 
             SuperscriptBox["rb", "2"], "+", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "ra"}], "+", "rb"}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["lcr", "2"], "-", 
             SuperscriptBox["lst", "2"], "+", 
             RowBox[{"ra", " ", "rb"}], "+", 
             SuperscriptBox["rb", "2"], "+", 
             RowBox[{"lcr", " ", 
              RowBox[{"(", 
               RowBox[{"ra", "+", 
                RowBox[{"2", " ", "rb"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"c1", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["lcr", "2"], "-", 
             SuperscriptBox["lst", "2"], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["ra", "2"]}], "-", 
             RowBox[{"3", " ", "ra", " ", "rb"}], "+", 
             SuperscriptBox["rb", "2"], "-", 
             RowBox[{"3", " ", "lcr", " ", "ra", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"2", " ", "lcr", " ", "rb", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"2", " ", "ra", " ", 
              RowBox[{"c2", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lcr", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", "t", "]"}], "2"], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["lcr", "2"], "-", 
                SuperscriptBox["lst", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["ra", "2"]}], "+", 
                SuperscriptBox["rb", "2"], "+", 
                RowBox[{"2", " ", "lcr", " ", "rb", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{"2", " ", "lcr", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"z", "[", "t", "]"}]}], "+", 
                SuperscriptBox[
                 RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
         ",", 
         RowBox[{
          SuperscriptBox["lcr", "2"], "-", 
          SuperscriptBox["lst", "2"], "+", 
          SuperscriptBox["ra", "2"], "-", 
          RowBox[{"2", " ", "ra", " ", "rb"}], "+", 
          SuperscriptBox["rb", "2"], "-", 
          RowBox[{"2", " ", "lcr", " ", "ra", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "lcr", " ", "rb", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"ra", " ", 
           RowBox[{"c2", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{"ra", " ", 
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "-", 
          RowBox[{
           SqrtBox["3"], " ", "ra", " ", 
           SuperscriptBox[
            RowBox[{"c1", "[", "t", "]"}], "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"c2", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "ra"}], "-", 
                RowBox[{"2", " ", "rb"}], "-", 
                RowBox[{"2", " ", "lcr", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "lcr", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"z", "[", "t", "]"}]}], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", "t", "]"}], "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c1", "[", "t", "]"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["lcr", "2"], "-", 
             SuperscriptBox["lst", "2"], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["ra", "2"]}], "-", 
             RowBox[{"ra", " ", "rb"}], "+", 
             SuperscriptBox["rb", "2"], "-", 
             RowBox[{"lcr", " ", 
              RowBox[{"(", 
               RowBox[{"ra", "-", 
                RowBox[{"2", " ", "rb"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["lcr", "2"], "-", 
             SuperscriptBox["lst", "2"], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["ra", "2"]}], "+", 
             RowBox[{"ra", " ", "rb"}], "+", 
             SuperscriptBox["rb", "2"], "+", 
             RowBox[{"lcr", " ", 
              RowBox[{"(", 
               RowBox[{"ra", "+", 
                RowBox[{"2", " ", "rb"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["lcr", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["lst", "2"]}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["ra", "2"]}], "-", 
             RowBox[{"ra", " ", "rb"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["rb", "2"]}], "-", 
             RowBox[{"lcr", " ", 
              RowBox[{"(", 
               RowBox[{"ra", "-", 
                RowBox[{"4", " ", "rb"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"4", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"z", "[", "t", "]"}], "2"]}]}], ")"}]}], "+", 
          RowBox[{
           SqrtBox["3"], " ", "ra", " ", 
           RowBox[{"c1", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"c2", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "ra"}], "+", "rb", "+", 
                RowBox[{"lcr", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "ra"}], "+", "rb", "+", 
                RowBox[{"lcr", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
             "-", 
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"z", "[", "t", "]"}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "lcr"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "+", 
                RowBox[{"z", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c1", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["lcr", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["lst", "2"]}], "+", 
             SuperscriptBox["ra", "2"], "-", 
             RowBox[{"3", " ", "ra", " ", "rb"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["rb", "2"]}], "-", 
             RowBox[{"3", " ", "lcr", " ", "ra", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"4", " ", "lcr", " ", "rb", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"ra", " ", 
              RowBox[{"c2", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lcr", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "-", 
             RowBox[{"4", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"z", "[", "t", "]"}], "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["lcr", "2"], "-", 
                SuperscriptBox["lst", "2"], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["ra", "2"]}], "+", 
                SuperscriptBox["rb", "2"], "+", 
                RowBox[{"2", " ", "lcr", " ", "rb", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{"2", " ", "lcr", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"z", "[", "t", "]"}]}], "+", 
                SuperscriptBox[
                 RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
         ",", 
         RowBox[{
          SuperscriptBox["lcr", "2"], "-", 
          SuperscriptBox["lst", "2"], "+", 
          SuperscriptBox["ra", "2"], "-", 
          RowBox[{"2", " ", "ra", " ", "rb"}], "+", 
          SuperscriptBox["rb", "2"], "-", 
          RowBox[{"2", " ", "lcr", " ", "ra", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "lcr", " ", "rb", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"ra", " ", 
           RowBox[{"c2", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{"ra", " ", 
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{
           SqrtBox["3"], " ", "ra", " ", 
           SuperscriptBox[
            RowBox[{"c1", "[", "t", "]"}], "3"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"c2", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "ra"}], "-", 
                RowBox[{"2", " ", "rb"}], "-", 
                RowBox[{"2", " ", "lcr", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "lcr", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}], " ", 
           RowBox[{"z", "[", "t", "]"}]}], "+", 
          SuperscriptBox[
           RowBox[{"z", "[", "t", "]"}], "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c1", "[", "t", "]"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["lcr", "2"], "-", 
             SuperscriptBox["lst", "2"], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["ra", "2"]}], "-", 
             RowBox[{"ra", " ", "rb"}], "+", 
             SuperscriptBox["rb", "2"], "-", 
             RowBox[{"lcr", " ", 
              RowBox[{"(", 
               RowBox[{"ra", "-", 
                RowBox[{"2", " ", "rb"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["lcr", "2"], "-", 
             SuperscriptBox["lst", "2"], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["ra", "2"]}], "+", 
             RowBox[{"ra", " ", "rb"}], "+", 
             SuperscriptBox["rb", "2"], "+", 
             RowBox[{"lcr", " ", 
              RowBox[{"(", 
               RowBox[{"ra", "+", 
                RowBox[{"2", " ", "rb"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             SuperscriptBox[
              RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["lcr", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["lst", "2"]}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["ra", "2"]}], "-", 
             RowBox[{"ra", " ", "rb"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["rb", "2"]}], "-", 
             RowBox[{"lcr", " ", 
              RowBox[{"(", 
               RowBox[{"ra", "-", 
                RowBox[{"4", " ", "rb"}]}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"4", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"z", "[", "t", "]"}], "2"]}]}], ")"}]}], "-", 
          RowBox[{
           SqrtBox["3"], " ", "ra", " ", 
           RowBox[{"c1", "[", "t", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"c2", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "ra"}], "+", "rb", "+", 
                RowBox[{"lcr", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "ra"}], "+", "rb", "+", 
                RowBox[{"lcr", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
             "-", 
             RowBox[{"lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"z", "[", "t", "]"}], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "lcr"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "+", 
                RowBox[{"z", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"c1", "[", "t", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["lcr", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["lst", "2"]}], "+", 
             SuperscriptBox["ra", "2"], "-", 
             RowBox[{"3", " ", "ra", " ", "rb"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["rb", "2"]}], "-", 
             RowBox[{"3", " ", "lcr", " ", "ra", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"4", " ", "lcr", " ", "rb", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"ra", " ", 
              RowBox[{"c2", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"lcr", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{"z", "[", "t", "]"}]}], ")"}]}], "-", 
             RowBox[{"4", " ", "lcr", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}], " ", 
              RowBox[{"z", "[", "t", "]"}]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"z", "[", "t", "]"}], "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"c2", "[", "t", "]"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["lcr", "2"], "-", 
                SuperscriptBox["lst", "2"], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["ra", "2"]}], "+", 
                SuperscriptBox["rb", "2"], "+", 
                RowBox[{"2", " ", "lcr", " ", "rb", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}]}], "-", 
                RowBox[{"2", " ", "lcr", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]3", "[", "t", "]"}], "]"}], " ", 
                 RowBox[{"z", "[", "t", "]"}]}], "+", 
                SuperscriptBox[
                 RowBox[{"z", "[", "t", "]"}], "2"]}], ")"}]}]}], ")"}]}]}]}],
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c1", "[", "t", "]"}], ",", 
         RowBox[{"c2", "[", "t", "]"}], ",", 
         RowBox[{"z", "[", "t", "]"}]}], "}"}]}], ";", "\n", "\t", 
      RowBox[{"dx", "=", 
       RowBox[{"D", "[", 
        RowBox[{"x", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ddx", "=", 
       RowBox[{"D", "[", 
        RowBox[{"dx", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
         RowBox[{"\[Theta]2", "[", "t", "]"}], ",", 
         RowBox[{"\[Theta]3", "[", "t", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d\[Theta]", "=", 
       RowBox[{"D", "[", 
        RowBox[{"\[Theta]", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dd\[Theta]", "=", 
       RowBox[{"D", "[", 
        RowBox[{"d\[Theta]", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"J\[Eta]\[Theta]", "=", 
       RowBox[{"D", "[", 
        RowBox[{"\[Eta]", ",", 
         RowBox[{"{", "\[Theta]", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dJ\[Eta]\[Theta]", "=", 
       RowBox[{"D", "[", 
        RowBox[{"J\[Eta]\[Theta]", ",", "t"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"J\[Eta]x", "=", 
       RowBox[{"D", "[", 
        RowBox[{"\[Eta]", ",", 
         RowBox[{"{", "x", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dJ\[Eta]x", "=", 
       RowBox[{"D", "[", 
        RowBox[{"J\[Eta]x", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"subsd\[Theta]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"vald\[Theta]", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"vald\[Theta]", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]3", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"vald\[Theta]", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"subsdd\[Theta]", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]1", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valdd\[Theta]", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]2", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valdd\[Theta]", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]3", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valdd\[Theta]", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"valdx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"Inverse", "[", "J\[Eta]x", "]"}], ".", 
            RowBox[{"(", 
             RowBox[{"J\[Eta]\[Theta]", ".", "d\[Theta]"}], ")"}]}]}], "/.", 
          "subs\[Beta]"}], "/.", "subscz"}], "/.", "subsd\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"subsdx", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c1", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valdx", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"c2", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valdx", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "'"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valdx", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"valddx", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              RowBox[{"Inverse", "[", "J\[Eta]x", "]"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"dJ\[Eta]x", ".", "dx"}], "+", 
                RowBox[{"dJ\[Eta]\[Theta]", ".", "d\[Theta]"}], "+", 
                RowBox[{"J\[Eta]\[Theta]", ".", "dd\[Theta]"}]}], ")"}]}]}], "/.",
             "subs\[Beta]"}], "/.", "subsd\[Theta]"}], "/.", "subscz"}], "/.",
          "subsdd\[Theta]"}], "/.", "subsdx"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"subsddx", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"c1", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valddx", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"c2", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valdd\[Theta]", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "''"}], "[", "t", "]"}], "\[Rule]", " ", 
          RowBox[{"valddx", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
        "subscz", ",", "subs\[Beta]", ",", "subsd\[Theta]", ",", 
         "subsdd\[Theta]", ",", "subsdx", ",", "subsddx"}], "}"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624300593200704*^9, 3.624300594752069*^9}, {
   3.624307253946968*^9, 3.624307256584218*^9}, {3.6344686939638033`*^9, 
   3.634468700415237*^9}, {3.63446897699294*^9, 3.6344690020785723`*^9}, {
   3.634469064581078*^9, 3.634469116723939*^9}, {3.665371014324885*^9, 
   3.665371014491008*^9}, {3.6653710790456047`*^9, 3.665371098799552*^9}, {
   3.665371150655547*^9, 3.6653713029332457`*^9}, {3.665371702115665*^9, 
   3.6653717260538797`*^9}, {3.665371765958426*^9, 3.665371923177087*^9}, {
   3.6653725042475767`*^9, 3.6653725143180523`*^9}, {3.6653747490888853`*^9, 
   3.665374851654358*^9}, {3.66537488410751*^9, 3.665374884455421*^9}, 
   3.665375084706911*^9, {3.665451413435184*^9, 3.665451417271317*^9}, {
   3.6654514936615562`*^9, 3.665451637259234*^9}, {3.665451812085834*^9, 
   3.665451872991559*^9}, {3.665451975608059*^9, 3.6654519779996033`*^9}, {
   3.676093147710093*^9, 3.67609315651663*^9}, 3.67609332330577*^9, {
   3.676095908559578*^9, 3.676095936229349*^9}, {3.6760961110677433`*^9, 
   3.6760961159155416`*^9}, 3.67609659054834*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"inverseKinematics23RRS", "[", 
    RowBox[{"valdd\[Theta]_", ",", "vald\[Theta]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]kx_", ",", "\[Phi]ky_"}], "}"}], ",", "\[Phi]_", ",", 
     "valz_", ",", 
     RowBox[{"{", 
      RowBox[{"rb_", ",", "lcr_", ",", "lst_", ",", "ra_"}], "}"}]}], "]"}], 
   ":="}], "*)"}]], "Input",
 CellChangeTimes->{{3.676096474126554*^9, 3.676096485734803*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"inverseKinematics23RRS", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", "0", ",", ".3", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rb", ",", "lcr", ",", "lst", ",", "ra"}], "}"}], "/.", 
     "data"}]}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.676096368667989*^9, 3.676096462741507*^9}, 
   3.676096496808153*^9, {3.676096531426939*^9, 3.6760965326661797`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"c1", "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"c2", "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"z", "[", "t", "]"}], "\[Rule]", "0.3`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", 
      RowBox[{"-", "0.09796110635456556`"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", 
      RowBox[{"-", "0.09796110635456556`"}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]3", "[", "t", "]"}], "\[Rule]", 
      RowBox[{"-", "0.09796110635456556`"}]}], ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "t", "]"}], "\[Rule]", "1.8550570762965954`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "t", "]"}], "\[Rule]", "1.8550570762965954`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]3", "[", "t", "]"}], "\[Rule]", 
      "1.8550570762965954`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "1.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "1.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]3", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "1.`"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Theta]3", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["c1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "0.38665192182527186`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["c1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["c2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "\[Rule]", 
      "0.15053227749180204`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.676096502061047*^9, 3.676096534860009*^9, 
  3.676096572055808*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot", "Section",
 CellChangeTimes->{{3.6239991526738443`*^9, 3.623999155900772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nsteps", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"change", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "nsteps"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loop", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "nsteps"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstorder", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "nsteps"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subsq", "=", 
   RowBox[{"val2rule", "[", 
    RowBox[{"qt", ",", 
     RowBox[{"qq", "[", "0", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subsdq", "=", 
   RowBox[{"val2rule", "[", 
    RowBox[{"dq", ",", 
     RowBox[{
      RowBox[{"qq", "'"}], "[", "0", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.676096824907915*^9, 3.676096825533388*^9}, {
  3.676096987086349*^9, 3.6760969880234203`*^9}}],

Cell[BoxData[
 RowBox[{"iEnergy", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{
        RowBox[{
         RowBox[{"qq", "'"}], "[", "0", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"subMq", "/.", "subsq"}], ")"}], ".", 
        RowBox[{
         RowBox[{"qq", "'"}], "[", "0", "]"}]}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Vsystem", "/.", "data"}], "/.", "subsqt"}], ")"}]}], "/.", 
    "subsq"}], "/.", "subsdq"}]}]], "Input"]
}, Open  ]]
},
WindowSize->{1307, 716},
WindowMargins->{{-10, Automatic}, {Automatic, -10}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 252, 5, 32, "Input"],
Cell[813, 27, 1577, 42, 209, "Input"],
Cell[2393, 71, 1241, 31, 143, "Input"],
Cell[3637, 104, 710, 15, 99, "Input"],
Cell[4350, 121, 1351, 34, 77, "Input"],
Cell[5704, 157, 710, 21, 32, "Input"],
Cell[CellGroupData[{
Cell[6439, 182, 147, 4, 32, "Input"],
Cell[6589, 188, 2514, 72, 54, "Output"]
}, Open  ]],
Cell[9118, 263, 4409, 117, 253, "Input"],
Cell[13530, 382, 166, 2, 32, "Input"],
Cell[13699, 386, 165, 2, 32, "Input"],
Cell[13867, 390, 909, 30, 99, "Input"],
Cell[14779, 422, 1882, 50, 143, "Input"],
Cell[16664, 474, 262, 6, 32, "Input"],
Cell[16929, 482, 564, 18, 55, "Input"],
Cell[17496, 502, 1476, 42, 99, "Input"],
Cell[18975, 546, 1499, 42, 99, "Input"],
Cell[20477, 590, 1711, 45, 99, "Input"],
Cell[22191, 637, 2423, 75, 165, "Input"],
Cell[24617, 714, 146, 3, 32, "Input"],
Cell[24766, 719, 2753, 80, 278, "Input"],
Cell[27522, 801, 643, 14, 55, "Input"],
Cell[28168, 817, 2229, 51, 121, "Input"],
Cell[30400, 870, 3501, 95, 121, "Input"],
Cell[33904, 967, 622, 17, 55, "Input"],
Cell[34529, 986, 1840, 47, 99, "Input"],
Cell[36372, 1035, 2931, 74, 297, "Input"],
Cell[39306, 1111, 727, 17, 165, "Input"],
Cell[40036, 1130, 193, 6, 55, "Input"],
Cell[40232, 1138, 1298, 38, 99, "Input"],
Cell[41533, 1178, 776, 23, 99, "Input"],
Cell[42312, 1203, 1547, 44, 99, "Input"],
Cell[43862, 1249, 775, 23, 99, "Input"],
Cell[44640, 1274, 594, 14, 55, "Input"],
Cell[45237, 1290, 722, 17, 55, "Input"],
Cell[45962, 1309, 792, 18, 77, "Input"],
Cell[46757, 1329, 442, 14, 77, "Input"],
Cell[47202, 1345, 959, 25, 99, "Input"],
Cell[48164, 1372, 555, 16, 77, "Input"],
Cell[48722, 1390, 931, 24, 99, "Input"],
Cell[49656, 1416, 374, 6, 32, "Input"],
Cell[50033, 1424, 1980, 54, 143, "Input"],
Cell[52016, 1480, 3596, 88, 187, "Input"],
Cell[55615, 1570, 676, 17, 55, "Input"],
Cell[56294, 1589, 519, 13, 77, "Input"],
Cell[56816, 1604, 298, 8, 32, "Input"],
Cell[57117, 1614, 5284, 133, 385, "Input"],
Cell[CellGroupData[{
Cell[62426, 1751, 1266, 23, 55, "Input"],
Cell[CellGroupData[{
Cell[63717, 1778, 783, 11, 23, "Print"],
Cell[64503, 1791, 783, 11, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[65313, 1806, 1988, 48, 77, "Input"],
Cell[CellGroupData[{
Cell[67326, 1858, 1973, 43, 121, "Input"],
Cell[69302, 1903, 2123, 49, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71462, 1957, 1410, 35, 55, "Input"],
Cell[72875, 1994, 253, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73165, 2003, 1161, 32, 55, "Input"],
Cell[74329, 2037, 229, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74595, 2045, 1165, 32, 55, "Input"],
Cell[75763, 2079, 249, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76049, 2087, 1188, 32, 55, "Input"],
Cell[77240, 2121, 240, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77517, 2129, 1163, 32, 55, "Input"],
Cell[78683, 2163, 222, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78942, 2172, 1161, 32, 55, "Input"],
Cell[80106, 2206, 239, 3, 32, "Output"]
}, Open  ]],
Cell[80360, 2212, 2051, 44, 77, "Input"],
Cell[82414, 2258, 1734, 40, 77, "Input"],
Cell[84151, 2300, 1791, 41, 99, "Input"],
Cell[85945, 2343, 1910, 54, 55, "Input"],
Cell[CellGroupData[{
Cell[87880, 2401, 926, 26, 55, "Input"],
Cell[88809, 2429, 153, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88999, 2436, 903, 26, 55, "Input"],
Cell[89905, 2464, 181, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90123, 2472, 882, 26, 55, "Input"],
Cell[91008, 2500, 185, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91230, 2508, 903, 26, 55, "Input"],
Cell[92136, 2536, 230, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92403, 2544, 882, 26, 55, "Input"],
Cell[93288, 2572, 183, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93508, 2580, 882, 26, 55, "Input"],
Cell[94393, 2608, 182, 3, 32, "Output"]
}, Open  ]],
Cell[94590, 2614, 1987, 46, 99, "Input"],
Cell[96580, 2662, 1862, 44, 99, "Input"],
Cell[98445, 2708, 1863, 44, 99, "Input"],
Cell[CellGroupData[{
Cell[100333, 2756, 1460, 33, 77, "Input"],
Cell[101796, 2791, 617, 9, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102450, 2805, 1130, 26, 55, "Input"],
Cell[103583, 2833, 369, 5, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103989, 2843, 1673, 34, 99, "Input"],
Cell[105665, 2879, 1127, 17, 187, "Output"]
}, Open  ]],
Cell[106807, 2899, 459, 7, 363, "Input"],
Cell[107269, 2908, 94, 1, 32, "Input"],
Cell[107366, 2911, 250, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[107641, 2920, 308, 7, 32, "Input"],
Cell[107952, 2929, 1053, 31, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109042, 2965, 258, 6, 32, "Input"],
Cell[109303, 2973, 4332, 104, 195, "Output"]
}, Open  ]],
Cell[113650, 3080, 4636, 95, 165, "Input"],
Cell[118289, 3177, 718, 20, 77, "Input"],
Cell[119010, 3199, 239, 6, 32, "Input"],
Cell[119252, 3207, 784, 14, 32, "Input"],
Cell[CellGroupData[{
Cell[120061, 3225, 500, 12, 32, "Input"],
Cell[CellGroupData[{
Cell[120586, 3241, 367, 6, 23, "Print"],
Cell[120956, 3249, 365, 6, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121370, 3261, 127, 2, 32, "Input"],
Cell[121500, 3265, 484, 9, 23, "Print"]
}, Open  ]],
Cell[121999, 3277, 487, 10, 32, "Input"],
Cell[122489, 3289, 333, 7, 32, "Input"],
Cell[122825, 3298, 304, 6, 32, "Input"],
Cell[123132, 3306, 3472, 77, 143, "Input"],
Cell[126607, 3385, 5424, 147, 297, "Input"],
Cell[132034, 3534, 2336, 63, 165, "Input"],
Cell[134373, 3599, 6284, 167, 429, "Input"],
Cell[140660, 3768, 3329, 90, 121, "Input"],
Cell[CellGroupData[{
Cell[144014, 3862, 1807, 49, 143, "Input"],
Cell[145824, 3913, 558, 10, 32, "Output"],
Cell[146385, 3925, 407, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146829, 3938, 1140, 33, 77, "Input"],
Cell[147972, 3973, 11996, 276, 194, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160005, 4254, 1129, 33, 77, "Input"],
Cell[161137, 4289, 277, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161451, 4298, 1326, 39, 55, "Input"],
Cell[162780, 4339, 772, 14, 23, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163589, 4358, 241, 13, 353, "Section"],
Cell[163833, 4373, 4307, 112, 319, "Input"],
Cell[CellGroupData[{
Cell[168165, 4489, 638, 13, 32, "Input"],
Cell[168806, 4504, 557, 12, 39, "Output"]
}, Open  ]],
Cell[169378, 4519, 6197, 161, 397, "Input"],
Cell[175578, 4682, 32987, 810, 1469, "Input"],
Cell[CellGroupData[{
Cell[208590, 5496, 844, 20, 32, "Input"],
Cell[209437, 5518, 4402, 127, 129, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[213888, 5651, 245, 3, 65, "Section"],
Cell[214136, 5656, 42437, 1025, 1689, "Input"],
Cell[256576, 6683, 448, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[257049, 6698, 591, 15, 32, "Input"],
Cell[257643, 6715, 3187, 92, 105, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[260879, 6813, 91, 1, 65, "Section"],
Cell[260973, 6816, 1025, 29, 165, "Input"],
Cell[262001, 6847, 547, 18, 32, "Input"]
}, Open  ]]
}
]
*)

